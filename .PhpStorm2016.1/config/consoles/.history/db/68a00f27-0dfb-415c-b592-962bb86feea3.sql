TRUNCATE TABLE SCHEDULES
;-- -. . -..- - / . -. - .-. -.--
DELETE FROM SCHEDULES WHERE 1
;-- -. . -..- - / . -. - .-. -.--
DELETE FROM SCHEDULES WHERE 1=1
;-- -. . -..- - / . -. - .-. -.--
DELETE FROM SCHEDULES
;-- -. . -..- - / . -. - .-. -.--
DELETE FROM STUDENTS
;-- -. . -..- - / . -. - .-. -.--
SELECT S.NAME
FROM STUDENTS S
  INNER JOIN APPLIES A
  INNER JOIN SCHEDULES SCH
  INNER JOIN PROPRIETOR_BARS PB
  INNER JOIN BARS B
  ON A.STUDENTS_ID = S.ID
  ON SCH.ID = A.SCHEDULES_ID
  ON PB.ID = SCH.PROPRIETOR_BARS_ID
  ON B.ID = PB.BARS_ID
WHERE
    SCH.BEGINDATETIME > TO_DATE('2016-05-01 00:00:00') AND
      SCH.ENDDATETIME < TO_DATE('2016-05-02 08:00:00') AND
      A.STATUS = 'PLANNED' AND
      B.NAME = 'Bar 8'
ORDER BY S.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT S.NAME
FROM STUDENTS S
  INNER JOIN APPLIES A
  INNER JOIN SCHEDULES SCH
  INNER JOIN PROPRIETOR_BARS PB
  INNER JOIN BARS B
  ON S.ID = A.STUDENTS_ID
  ON SCH.ID = A.SCHEDULES_ID
  ON PB.ID = SCH.PROPRIETOR_BARS_ID
  ON B.ID = PB.BARS_ID
WHERE
    SCH.BEGINDATETIME > TO_DATE('2016-05-01 00:00:00') AND
      SCH.ENDDATETIME < TO_DATE('2016-05-02 08:00:00') AND
      A.STATUS = 'PLANNED' AND
      B.NAME = 'Bar 8'
ORDER BY S.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT S.NAME
FROM STUDENTS S
  JOIN APPLIES A
  JOIN SCHEDULES SCH
  JOIN PROPRIETOR_BARS PB
  JOIN BARS B
  ON S.ID = A.STUDENTS_ID
  ON SCH.ID = A.SCHEDULES_ID
  ON PB.ID = SCH.PROPRIETOR_BARS_ID
  ON B.ID = PB.BARS_ID
WHERE
    SCH.BEGINDATETIME > TO_DATE('2016-05-01 00:00:00') AND
      SCH.ENDDATETIME < TO_DATE('2016-05-02 08:00:00') AND
      A.STATUS = 'PLANNED' AND
      B.NAME = 'Bar 8'
ORDER BY S.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT S.NAME
FROM STUDENTS S
  JOIN APPLIES A
  JOIN SCHEDULES SCH
  JOIN PROPRIETOR_BARS PB
  JOIN BARS B
  ON A.STUDENTS_ID = S.ID
  ON SCH.ID = A.SCHEDULES_ID
  ON PB.ID = SCH.PROPRIETOR_BARS_ID
  ON B.ID = PB.BARS_ID
WHERE
    SCH.BEGINDATETIME > TO_DATE('2016-05-01 00:00:00') AND
      SCH.ENDDATETIME < TO_DATE('2016-05-02 08:00:00') AND
      A.STATUS = 'PLANNED' AND
      B.NAME = 'Bar 8'
ORDER BY S.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME
FROM STUDENTS
  JOIN APPLIES
  JOIN SCHEDULES
  JOIN PROPRIETOR_BARS
  JOIN BARS
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  SCHEDULES.BEGINDATETIME > TO_DATE('2016-05-01 00:00:00') AND
  SCHEDULES.ENDDATETIME < TO_DATE('2016-05-02 08:00:00') AND
  APPLIES.STATUS = 'PLANNED' AND
  BARS.NAME = 'Bar 8'
ORDER BY STUDENTS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME
FROM STUDENTS
  RIGHT JOIN APPLIES
  JOIN SCHEDULES
  JOIN PROPRIETOR_BARS
  JOIN BARS
    ON APPLIES.STUDENTS_ID = ID
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  SCHEDULES.BEGINDATETIME > TO_DATE('2016-05-01 00:00:00') AND
  SCHEDULES.ENDDATETIME < TO_DATE('2016-05-02 08:00:00') AND
  APPLIES.STATUS = 'PLANNED' AND
  BARS.NAME = 'Bar 8'
ORDER BY STUDENTS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME
FROM STUDENTS
  RIGHT JOIN APPLIES
  JOIN SCHEDULES
  JOIN PROPRIETOR_BARS
  JOIN BARS
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  SCHEDULES.BEGINDATETIME > TO_DATE('2016-05-01 00:00:00') AND
  SCHEDULES.ENDDATETIME < TO_DATE('2016-05-02 08:00:00') AND
  APPLIES.STATUS = 'PLANNED' AND
  BARS.NAME = 'Bar 8'
ORDER BY STUDENTS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME
FROM STUDENTS
  RIGHT JOIN APPLIES
  RIGHT JOIN SCHEDULES
  RIGHT JOIN PROPRIETOR_BARS
  RIGHT JOIN BARS
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  SCHEDULES.BEGINDATETIME > TO_DATE('2016-05-01 00:00:00') AND
  SCHEDULES.ENDDATETIME < TO_DATE('2016-05-02 08:00:00') AND
  APPLIES.STATUS = 'PLANNED' AND
  BARS.NAME = 'Bar 8'
ORDER BY STUDENTS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME
FROM STUDENTS
  FULL JOIN APPLIES
  RIGHT JOIN SCHEDULES
  RIGHT JOIN PROPRIETOR_BARS
  RIGHT JOIN BARS
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  SCHEDULES.BEGINDATETIME > TO_DATE('2016-05-01 00:00:00') AND
  SCHEDULES.ENDDATETIME < TO_DATE('2016-05-02 08:00:00') AND
  APPLIES.STATUS = 'PLANNED' AND
  BARS.NAME = 'Bar 8'
ORDER BY STUDENTS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME
FROM STUDENTS
  LEFT JOIN APPLIES
  JOIN SCHEDULES
  JOIN PROPRIETOR_BARS
  JOIN BARS
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  SCHEDULES.BEGINDATETIME > TO_DATE('2016-05-01 00:00:00') AND
  SCHEDULES.ENDDATETIME < TO_DATE('2016-05-02 08:00:00') AND
  APPLIES.STATUS = 'PLANNED' AND
  BARS.NAME = 'Bar 8'
ORDER BY STUDENTS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME
FROM STUDENTS
  JOIN APPLIES
    ON APPLIES.STUDENTS_ID = STUDENTS.ID

  JOIN SCHEDULES
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID

  JOIN PROPRIETOR_BARS
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID

  JOIN BARS
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
  
WHERE
  SCHEDULES.BEGINDATETIME > TO_DATE('2016-05-01 00:00:00') AND
  SCHEDULES.ENDDATETIME < TO_DATE('2016-05-02 08:00:00') AND
  APPLIES.STATUS = 'PLANNED' AND
  BARS.NAME = 'Bar 8'
ORDER BY STUDENTS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME
FROM STUDENTS
  INNER JOIN APPLIES
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
  INNER JOIN SCHEDULES
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
  INNER JOIN PROPRIETOR_BARS
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
  INNER JOIN BARS
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  SCHEDULES.BEGINDATETIME > TO_DATE('2016-05-01 00:00:00') AND
  SCHEDULES.ENDDATETIME < TO_DATE('2016-05-02 08:00:00') AND
  APPLIES.STATUS = 'PLANNED' AND
  BARS.NAME = 'Bar 8'
ORDER BY STUDENTS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME
FROM STUDENTS
  INNER JOIN APPLIES
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
  INNER JOIN SCHEDULES
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
  INNER JOIN PROPRIETOR_BARS
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
  INNER JOIN BARS
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  SCHEDULES.BEGINDATETIME > '2016-05-01 00:00:00' AND
  SCHEDULES.ENDDATETIME < '2016-05-02 08:00:00' AND
  APPLIES.STATUS = 'PLANNED' AND
  BARS.NAME = 'Bar 8'
ORDER BY STUDENTS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME
FROM STUDENTS
  LEFT JOIN APPLIES
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
  INNER JOIN SCHEDULES
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
  INNER JOIN PROPRIETOR_BARS
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
  INNER JOIN BARS
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  SCHEDULES.BEGINDATETIME > '2016-05-01 00:00:00' AND
  SCHEDULES.ENDDATETIME < '2016-05-02 08:00:00' AND
  APPLIES.STATUS = 'PLANNED' AND
  BARS.NAME = 'Bar 8'
ORDER BY STUDENTS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME
FROM STUDENTS
  INNER JOIN APPLIES
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
  INNER JOIN SCHEDULES
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
  INNER JOIN PROPRIETOR_BARS
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
  INNER JOIN BARS
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  SCHEDULES.BEGINDATETIME > '2016-05-01 00:00:55' AND
  SCHEDULES.ENDDATETIME < '2016-05-02 08:00:00' AND
  APPLIES.STATUS = 'PLANNED' AND
  BARS.NAME = 'Bar 8'
ORDER BY STUDENTS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME
FROM STUDENTS
  INNER JOIN APPLIES
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
  INNER JOIN SCHEDULES
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
  INNER JOIN PROPRIETOR_BARS
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
  INNER JOIN BARS
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  SCHEDULES.BEGINDATETIME > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD') AND
  SCHEDULES.ENDDATETIME < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD') AND
  APPLIES.STATUS = 'PLANNED' AND
  BARS.NAME = 'Bar 8'
ORDER BY STUDENTS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME
FROM STUDENTS
  INNER JOIN APPLIES
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
  INNER JOIN SCHEDULES
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
  INNER JOIN PROPRIETOR_BARS
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
  INNER JOIN BARS
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  SCHEDULES.BEGINDATETIME > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD HH24:MI:SS') AND
  SCHEDULES.ENDDATETIME < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD HH24:MI:SS') AND
  APPLIES.STATUS = 'PLANNED' AND
  BARS.NAME = 'Bar 8'
ORDER BY STUDENTS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME
FROM STUDENTS
  JOIN APPLIES
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
  JOIN SCHEDULES
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
  JOIN PROPRIETOR_BARS
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
  JOIN BARS
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  SCHEDULES.BEGINDATETIME > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD HH24:MI:SS') AND
  SCHEDULES.ENDDATETIME < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD HH24:MI:SS') AND
  APPLIES.STATUS = 'PLANNED' AND
  BARS.NAME = 'Bar 8'
ORDER BY STUDENTS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT ITEMS.NAME, ITEMS.TYPE, STUDENTS.NAME, SUM(ORDERITEMS."NUMBER")
FROM ITEMS
  JOIN ORDERITEMS
    ON ITEMS.ID = ORDERITEMS.ITEMS_ID
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN BARS
    ON ORDERS.BARS_ID = BARS.ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
WHERE
  SCHEDULES.BEGINDATETIME > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD HH24:MI:SS') AND
  SCHEDULES.ENDDATETIME < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD HH24:MI:SS') AND
  APPLIES.STATUS = 'PLANNED' AND
  BARS.NAME = 'Bar 7'
GROUP BY ITEMS.TYPE
ORDER BY ITEMS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT ITEMS.NAME, ITEMS.TYPE, STUDENTS.NAME, SUM(ORDERITEMS."NUMBER")
FROM ITEMS
  JOIN ORDERITEMS
    ON ITEMS.ID = ORDERITEMS.ITEMS_ID
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN BARS
    ON ORDERS.BARS_ID = BARS.ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
WHERE
  SCHEDULES.BEGINDATETIME > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD HH24:MI:SS') AND
  SCHEDULES.ENDDATETIME < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD HH24:MI:SS') AND
  BARS.NAME = 'Bar 7'
GROUP BY ITEMS.TYPE
ORDER BY ITEMS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT ITEMS.NAME, ITEMS.TYPE, STUDENTS.NAME, SUM(ORDERITEMS."NUMBER")
FROM ITEMS
  JOIN ORDERITEMS
    ON ITEMS.ID = ORDERITEMS.ITEMS_ID
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN BARS
    ON ORDERS.BARS_ID = BARS.ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
WHERE
  ORDERS.DATEORDER > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD HH24:MI:SS') AND
  ORDERS.DATEORDER < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD HH24:MI:SS') AND
  BARS.NAME = 'Bar 7'
GROUP BY ITEMS.TYPE
ORDER BY ITEMS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT ITEMS.NAME, ITEMS.TYPE, STUDENTS.NAME, SUM(ORDERITEMS."NUMBER")
FROM ITEMS
  JOIN ORDERITEMS
    ON ITEMS.ID = ORDERITEMS.ITEMS_ID
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN BARS
    ON ORDERS.BARS_ID = BARS.ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
WHERE
  ORDERS.DATEORDER > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD HH24:MI:SS') AND
  ORDERS.DATEORDER < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD HH24:MI:SS') AND
  BARS.NAME = 'Bar 7'
GROUP BY ITEMS.TYPE, STUDENTS.NAME
ORDER BY ITEMS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT ITEMS.NAME, ITEMS.TYPE, STUDENTS.NAME, COUNT(ORDERITEMS."NUMBER") AS TOTALITEMS
FROM ITEMS
  JOIN ORDERITEMS
    ON ITEMS.ID = ORDERITEMS.ITEMS_ID
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN BARS
    ON ORDERS.BARS_ID = BARS.ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
WHERE
  ORDERS.DATEORDER > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD HH24:MI:SS') AND
  ORDERS.DATEORDER < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD HH24:MI:SS') AND
  BARS.NAME = 'Bar 7'
GROUP BY ITEMS.TYPE, STUDENTS.NAME
ORDER BY ITEMS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT ITEMS.TYPE, STUDENTS.NAME, SUM(ORDERITEMS."NUMBER") AS TOTALITEMS
FROM ITEMS
  JOIN ORDERITEMS
    ON ITEMS.ID = ORDERITEMS.ITEMS_ID
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN BARS
    ON ORDERS.BARS_ID = BARS.ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
WHERE
  ORDERS.DATEORDER > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD HH24:MI:SS') AND
  ORDERS.DATEORDER < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD HH24:MI:SS') AND
  BARS.NAME = 'Bar 7'
GROUP BY ITEMS.TYPE, STUDENTS.NAME
ORDER BY ITEMS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT SUM(ORDERITEMS."NUMBER") AS TOTALITEMS
FROM ITEMS
  JOIN ORDERITEMS
    ON ITEMS.ID = ORDERITEMS.ITEMS_ID
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN BARS
    ON ORDERS.BARS_ID = BARS.ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
WHERE
  ORDERS.DATEORDER > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD HH24:MI:SS') AND
  ORDERS.DATEORDER < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD HH24:MI:SS') AND
  BARS.NAME = 'Bar 7'
GROUP BY ITEMS.TYPE, STUDENTS.NAME
ORDER BY ITEMS.NAME
;-- -. . -..- - / . -. - .-. -.--
ITEMS.TYPE, STUDENTS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT ITEMS.TYPE AS ITEMTYPE, STUDENTS.NAME AS STUDENTNAME, SUM(ORDERITEMS."NUMBER") AS TOTALITEMS
FROM ITEMS
  JOIN ORDERITEMS
    ON ITEMS.ID = ORDERITEMS.ITEMS_ID
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN BARS
    ON ORDERS.BARS_ID = BARS.ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
WHERE
  ORDERS.DATEORDER > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD HH24:MI:SS') AND
  ORDERS.DATEORDER < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD HH24:MI:SS') AND
  BARS.NAME = 'Bar 7'
GROUP BY ITEMS.TYPE, STUDENTS.NAME
ORDER BY ITEMS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT ITEMS.TYPE AS ITEMTYPE, STUDENTS.NAME AS STUDENTNAME, SUM(ORDERITEMS."NUMBER") AS TOTALITEMS
FROM ITEMS
  JOIN ORDERITEMS
    ON ITEMS.ID = ORDERITEMS.ITEMS_ID
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN BARS
    ON ORDERS.BARS_ID = BARS.ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
WHERE
  ORDERS.DATEORDER > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD HH24:MI:SS') AND
  ORDERS.DATEORDER < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD HH24:MI:SS') AND
  BARS.NAME = 'Bar 7'
GROUP BY ITEMS.TYPE, STUDENTS.NAME, TOTALITEMS
ORDER BY ITEMS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT ITEMS.TYPE, STUDENTS.NAME, SUM(ORDERITEMS."NUMBER") AS TOTALITEMS
FROM ITEMS
  JOIN ORDERITEMS
    ON ITEMS.ID = ORDERITEMS.ITEMS_ID
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN BARS
    ON ORDERS.BARS_ID = BARS.ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
WHERE
  ORDERS.DATEORDER > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD HH24:MI:SS') AND
  ORDERS.DATEORDER < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD HH24:MI:SS') AND
  BARS.NAME = 'Bar 7'
GROUP BY ITEMS.TYPE, STUDENTS.NAME, TOTALITEMS
ORDER BY ITEMS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT ITEMS.TYPE, STUDENTS.NAME
FROM ITEMS
  JOIN ORDERITEMS
    ON ITEMS.ID = ORDERITEMS.ITEMS_ID
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN BARS
    ON ORDERS.BARS_ID = BARS.ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
WHERE
  ORDERS.DATEORDER > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD HH24:MI:SS') AND
  ORDERS.DATEORDER < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD HH24:MI:SS') AND
  BARS.NAME = 'Bar 7'
GROUP BY ITEMS.TYPE, STUDENTS.NAME, SUM(ORDERITEMS."NUMBER") AS TOTALITEMS
ORDER BY ITEMS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT ITEMS.TYPE, STUDENTS.NAME
FROM ITEMS
  JOIN ORDERITEMS
    ON ITEMS.ID = ORDERITEMS.ITEMS_ID
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN BARS
    ON ORDERS.BARS_ID = BARS.ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
WHERE
  ORDERS.DATEORDER > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD HH24:MI:SS') AND
  ORDERS.DATEORDER < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD HH24:MI:SS') AND
  BARS.NAME = 'Bar 7'
GROUP BY ITEMS.TYPE, STUDENTS.NAME, COUNT(ORDERITEMS."NUMBER")
ORDER BY ITEMS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT ITEMS.TYPE, STUDENTS.NAME, SUM(ORDERITEMS."NUMBER") AS TOTALITEMS
FROM ITEMS
  JOIN ORDERITEMS
    ON ITEMS.ID = ORDERITEMS.ITEMS_ID
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN BARS
    ON ORDERS.BARS_ID = BARS.ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
WHERE
  ORDERS.DATEORDER > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD HH24:MI:SS') AND
  ORDERS.DATEORDER < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD HH24:MI:SS') AND
  BARS.NAME = 'Bar 7'
GROUP BY ITEMS.TYPE
ORDER BY ITEMS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT ITEMS.TYPE, STUDENTS.NAME, SUM(ORDERITEMS."NUMBER") AS TOTALITEMS
FROM ITEMS
  JOIN ORDERITEMS
    ON ITEMS.ID = ORDERITEMS.ITEMS_ID
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN BARS
    ON ORDERS.BARS_ID = BARS.ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
WHERE
  ORDERS.DATEORDER > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD HH24:MI:SS') AND
  ORDERS.DATEORDER < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD HH24:MI:SS') AND
  BARS.NAME = 'Bar 7'
GROUP BY ITEMS.TYPE, STUDENTS.ID, TOTALITEMS
;-- -. . -..- - / . -. - .-. -.--
SELECT ITEMS.TYPE, STUDENTS.NAME, SUM(ORDERITEMS."NUMBER") AS TOTALITEMS
FROM ITEMS
  JOIN ORDERITEMS
    ON ITEMS.ID = ORDERITEMS.ITEMS_ID
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN BARS
    ON ORDERS.BARS_ID = BARS.ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
WHERE
  ORDERS.DATEORDER > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD HH24:MI:SS') AND
  ORDERS.DATEORDER < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD HH24:MI:SS') AND
  BARS.NAME = 'Bar 7'
GROUP BY ITEMS.TYPE, STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT ITEMS.TYPE, STUDENTS.NAME, SUM(ORDERITEMS."NUMBER") AS TOTALITEMS
FROM ITEMS
  JOIN ORDERITEMS
    ON ITEMS.ID = ORDERITEMS.ITEMS_ID
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN BARS
    ON ORDERS.BARS_ID = BARS.ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
WHERE
  ORDERS.DATEORDER > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD HH24:MI:SS') AND
  ORDERS.DATEORDER < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD HH24:MI:SS') AND
  BARS.NAME = 'Bar 7'
;-- -. . -..- - / . -. - .-. -.--
SELECT ITEMS.TYPE, STUDENTS.NAME, SUM(ORDERITEMS."NUMBER") AS TOTALITEMS
FROM ITEMS
  JOIN ORDERITEMS
    ON ITEMS.ID = ORDERITEMS.ITEMS_ID
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN BARS
    ON ORDERS.BARS_ID = BARS.ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
WHERE
  ORDERS.DATEORDER > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD HH24:MI:SS') AND
  ORDERS.DATEORDER < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD HH24:MI:SS') AND
  BARS.NAME = 'Bar 7'
ORDER BY STUDENTS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT ITEMS.TYPE, STUDENTS.NAME, SUM(ORDERITEMS."NUMBER") AS TOTALITEMS
FROM ITEMS
  JOIN ORDERITEMS
    ON ITEMS.ID = ORDERITEMS.ITEMS_ID
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN BARS
    ON ORDERS.BARS_ID = BARS.ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
WHERE
  ORDERS.DATEORDER > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD HH24:MI:SS') AND
  ORDERS.DATEORDER < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD HH24:MI:SS') AND
  BARS.NAME = 'Bar 7'
GROUP BY STUDENTS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT ITEMS.TYPE, STUDENTS.NAME, SUM(ORDERITEMS."NUMBER") AS TOTALITEMS
FROM ITEMS
  JOIN ORDERITEMS
    ON ITEMS.ID = ORDERITEMS.ITEMS_ID
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN BARS
    ON ORDERS.BARS_ID = BARS.ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
WHERE
  ORDERS.DATEORDER > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD HH24:MI:SS') AND
  ORDERS.DATEORDER < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD HH24:MI:SS') AND
  BARS.NAME = 'Bar 7'
GROUP BY ITEMS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT ITEMS.TYPE, STUDENTS.NAME, SUM(ORDERITEMS."NUMBER") AS TOTALITEMS
FROM ITEMS
  JOIN ORDERITEMS
    ON ITEMS.ID = ORDERITEMS.ITEMS_ID
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN BARS
    ON ORDERS.BARS_ID = BARS.ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
WHERE
  ORDERS.DATEORDER > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD HH24:MI:SS') AND
  ORDERS.DATEORDER < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD HH24:MI:SS') AND
  BARS.NAME = 'Bar 7'
GROUP BY ITEMS.ID, ITEMS.TYPE, STUDENTS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT ITEMS.TYPE, STUDENTS.NAME, SUM(ORDERITEMS."NUMBER") AS TOTALITEMS
FROM ITEMS
  JOIN ORDERITEMS
    ON ITEMS.ID = ORDERITEMS.ITEMS_ID
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN BARS
    ON ORDERS.BARS_ID = BARS.ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
WHERE
  ORDERS.DATEORDER > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD HH24:MI:SS') AND
  ORDERS.DATEORDER < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD HH24:MI:SS') AND
  BARS.NAME = 'Bar 7'
GROUP BY ITEMS.ID, ITEMS.TYPE, STUDENTS.NAME
ORDER BY ITEMS.TYPE
;-- -. . -..- - / . -. - .-. -.--
SELECT ITEMS.TYPE, STUDENTS.NAME, SUM(ORDERITEMS."NUMBER") AS TOTALITEMS, BARS.ID
FROM ITEMS
  JOIN ORDERITEMS
    ON ITEMS.ID = ORDERITEMS.ITEMS_ID
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN BARS
    ON ORDERS.BARS_ID = BARS.ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
WHERE
  ORDERS.DATEORDER > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD HH24:MI:SS') AND
  ORDERS.DATEORDER < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD HH24:MI:SS') AND
  BARS.NAME = 'Bar 7'
GROUP BY ITEMS.ID, ITEMS.TYPE, STUDENTS.NAME
ORDER BY ITEMS.TYPE
;-- -. . -..- - / . -. - .-. -.--
SELECT ITEMS.TYPE, STUDENTS.NAME, SUM(ORDERITEMS."NUMBER") AS TOTALITEMS, BARS.ID
FROM ITEMS
  JOIN ORDERITEMS
    ON ITEMS.ID = ORDERITEMS.ITEMS_ID
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN BARS
    ON ORDERS.BARS_ID = BARS.ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
WHERE
  ORDERS.DATEORDER > TO_DATE('2016-05-01 00:00:55', 'YYYY-MM-DD HH24:MI:SS') AND
  ORDERS.DATEORDER < TO_DATE('2016-05-02 08:00:00', 'YYYY-MM-DD HH24:MI:SS') AND
  BARS.NAME = 'Bar 7'
GROUP BY ITEMS.ID, ITEMS.TYPE, STUDENTS.NAME, BARS.ID
ORDER BY ITEMS.TYPE
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME, APPLIES.STATUS, APPLIES.CAPACITY, BARS.NAME, EVENTS.NAME
FROM STUDENTS
  JOIN APPLIES
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
  JOIN SCHEDULES
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
  JOIN EVENTS
    ON EVENTS.ID = SCHEDULES.EVENTS_ID
  JOIN PROPRIETOR_BARS
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
  JOIN BARS
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  APPLIES.CAPACITY == 'WAITER'
GROUP BY EVENTS.NAME
;-- -. . -..- - / . -. - .-. -.--
PLIES.STATUS, APPLIES.CAPACITY, BARS.NAME, EVENTS.NAME
FROM STUDENTS
  JOIN APPLIES
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
  JOIN SCHEDULES
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
  JOIN EVENTS
    ON EVENTS.ID = SCHEDULES.EVENTS_I
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME, APPLIES.STATUS, APPLIES.CAPACITY, BARS.NAME, EVENTS.NAME
FROM STUDENTS
  JOIN APPLIES
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
  JOIN SCHEDULES
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
  JOIN EVENTS
    ON EVENTS.ID = SCHEDULES.EVENTS_ID
  JOIN PROPRIETOR_BARS
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
  JOIN BARS
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  APPLIES.CAPACITY = 'WAITER'
GROUP BY STUDENTS.ID, EVENTS.NAME, APPLIES.STATUS, BARS.NAME, STUDENTS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME, APPLIES.STATUS, APPLIES.CAPACITY, BARS.NAME, EVENTS.NAME
FROM STUDENTS
  JOIN APPLIES
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
  JOIN SCHEDULES
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
  JOIN EVENTS
    ON EVENTS.ID = SCHEDULES.EVENTS_ID
  JOIN PROPRIETOR_BARS
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
  JOIN BARS
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  APPLIES.CAPACITY = 'WAITER'
GROUP BY APPLIES.ID, EVENTS.NAME, APPLIES.STATUS, BARS.NAME, STUDENTS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME, APPLIES.STATUS, APPLIES.CAPACITY, BARS.NAME, EVENTS.NAME
FROM STUDENTS
  JOIN APPLIES
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
  JOIN SCHEDULES
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
  JOIN EVENTS
    ON EVENTS.ID = SCHEDULES.EVENTS_ID
  JOIN PROPRIETOR_BARS
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
  JOIN BARS
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  APPLIES.CAPACITY = 'WAITER'
GROUP BY EVENTS.NAME, APPLIES.STATUS, BARS.NAME, STUDENTS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME, APPLIES.STATUS, APPLIES.CAPACITY, BARS.NAME, EVENTS.NAME
FROM STUDENTS
  JOIN APPLIES
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
  JOIN SCHEDULES
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
  JOIN EVENTS
    ON EVENTS.ID = SCHEDULES.EVENTS_ID
  JOIN PROPRIETOR_BARS
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
  JOIN BARS
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  APPLIES.CAPACITY = 'WAITER'
GROUP BY EVENTS
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME, APPLIES.STATUS, APPLIES.CAPACITY, BARS.NAME, EVENTS.NAME
FROM STUDENTS
  JOIN APPLIES
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
  JOIN SCHEDULES
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
  JOIN EVENTS
    ON EVENTS.ID = SCHEDULES.EVENTS_ID
  JOIN PROPRIETOR_BARS
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
  JOIN BARS
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  APPLIES.CAPACITY = 'WAITER'
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME, APPLIES.STATUS, APPLIES.CAPACITY, BARS.NAME, EVENTS.NAME
FROM STUDENTS
  JOIN APPLIES
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
  JOIN SCHEDULES
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
  JOIN EVENTS
    ON EVENTS.ID = SCHEDULES.EVENTS_ID
  JOIN PROPRIETOR_BARS
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
  JOIN BARS
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  APPLIES.CAPACITY = 'WAITER'
GROUP BY APPLIES.STATUS
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME, APPLIES.STATUS AS STATUS, APPLIES.CAPACITY, BARS.NAME, EVENTS.NAME
FROM STUDENTS
  JOIN APPLIES
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
  JOIN SCHEDULES
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
  JOIN EVENTS
    ON EVENTS.ID = SCHEDULES.EVENTS_ID
  JOIN PROPRIETOR_BARS
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
  JOIN BARS
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  APPLIES.CAPACITY = 'WAITER'
GROUP BY STATUS
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME, APPLIES.STATUS, APPLIES.CAPACITY, BARS.NAME, EVENTS.NAME
FROM STUDENTS
  JOIN APPLIES
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
  JOIN SCHEDULES
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
  JOIN EVENTS
    ON EVENTS.ID = SCHEDULES.EVENTS_ID
  JOIN PROPRIETOR_BARS
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
  JOIN BARS
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  APPLIES.CAPACITY = 'WAITER'
GROUP BY EVENTS.NAME, STUDENTS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME, APPLIES.STATUS, APPLIES.CAPACITY, BARS.NAME, EVENTS.NAME
FROM STUDENTS
  JOIN APPLIES
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
  JOIN SCHEDULES
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
  JOIN EVENTS
    ON EVENTS.ID = SCHEDULES.EVENTS_ID
  JOIN PROPRIETOR_BARS
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
  JOIN BARS
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  APPLIES.CAPACITY = 'WAITER'
GROUP BY EVENTS.NAME, STUDENTS.NAME, SCHEDULES.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME, APPLIES.STATUS, APPLIES.CAPACITY, BARS.NAME, EVENTS.NAME
FROM STUDENTS
  JOIN APPLIES
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
  JOIN SCHEDULES
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
  JOIN EVENTS
    ON EVENTS.ID = SCHEDULES.EVENTS_ID
  JOIN PROPRIETOR_BARS
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
  JOIN BARS
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  APPLIES.CAPACITY = 'WAITER'
GROUP BY EVENTS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME, APPLIES.STATUS, APPLIES.CAPACITY, BARS.NAME, EVENTS.NAME
FROM STUDENTS
  JOIN APPLIES
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
  JOIN SCHEDULES
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
  JOIN EVENTS
    ON EVENTS.ID = SCHEDULES.EVENTS_ID
  JOIN PROPRIETOR_BARS
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
  JOIN BARS
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  APPLIES.CAPACITY = 'WAITER'
GROUP BY EVENTS.NAME, STUDENTS.NAME, APPLIES.STATUS, APPLIES.CAPACITY, BARS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME, APPLIES.STATUS, APPLIES.CAPACITY, BARS.NAME, EVENTS.NAME
FROM STUDENTS
  JOIN APPLIES
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
  JOIN SCHEDULES
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
  JOIN EVENTS
    ON EVENTS.ID = SCHEDULES.EVENTS_ID
  JOIN PROPRIETOR_BARS
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
  JOIN BARS
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  APPLIES.CAPACITY = 'WAITER'
GROUP BY EVENTS.NAME, APPLIES.STATUS, STUDENTS.NAME, APPLIES.CAPACITY, BARS.NAME
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.NAME, APPLIES.STATUS, APPLIES.CAPACITY, BARS.NAME, EVENTS.NAME
FROM STUDENTS
  JOIN APPLIES
    ON APPLIES.STUDENTS_ID = STUDENTS.ID
  JOIN SCHEDULES
    ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
  JOIN EVENTS
    ON EVENTS.ID = SCHEDULES.EVENTS_ID
  JOIN PROPRIETOR_BARS
    ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
  JOIN BARS
    ON BARS.ID = PROPRIETOR_BARS.BARS_ID
WHERE
  APPLIES.CAPACITY = 'WAITER'
GROUP BY EVENTS.NAME, BARS.NAME, APPLIES.STATUS, STUDENTS.NAME, APPLIES.CAPACITY
;-- -. . -..- - / . -. - .-. -.--
SELECT to_number(to_char(to_date(SCHEDULES.ENDDATETIME), 'HH24'))-to_number(to_char(to_date(SCHEDULES.BEGINDATETIME), 'H24'))
  AS amountOfHoursWorked
FROM EVENTS
  JOIN SCHEDULES
    ON SCHEDULES.EVENTS_ID = EVENTS.ID
  JOIN APPLIES
    ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
  JOIN STUDENTS
    ON STUDENTS.ID = APPLIES.STUDENTS_ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND      -- With PLANNED status and not being COUPON_SELLER we
  APPLIES.CAPACITY != 'COUPON_SELLER'
;-- -. . -..- - / . -. - .-. -.--
US
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID,
  STUDENTS.ID,
  ITEMS.NUMBER_OF_COUPONS * ORDERITEMS.NUMBER AS COLLECTED_COUPONS,
  4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS.NUMBER) * 1.00 * 1.04 AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID,
  STUDENTS.ID,
  ITEMS.NUMBER_OF_COUPONS * ORDERITEMS.NUMBER AS collectedCoupons,
  4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS.NUMBER) * 1.00 * 1.04 AS bonusAmount
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID,
  STUDENTS.ID,
  ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER" AS collectedCoupons,
  4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") * 1.00 * 1.04 AS bonusAmount
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID,
  STUDENTS.ID,
  ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER" AS collectedCoupons,
  4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") * 1.00 * 1.04 AS bonusAmount
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER" AS COLLECTED_COUPONS,
  4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") * 1.00 * 1.04 AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS COLLECTED_COUPONS,
  4 * SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") * 1.00 * 1.04 AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS COLLECTED_COUPONS,
  4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") * 1.00 * 1.04 AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT 
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS COLLECTED_COUPONS,
  SUM(4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") * 1.00 * 1.04) AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS COLLECTED_COUPONS,
  SUM(4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") * 1.00 * 1.04) AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT 
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS COLLECTED_COUPONS,
  SUM(4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") * 1.00 * 1.04) AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS_ID, STUDENTS_ID, COLLECTED_COUPONS, BONUS_AMOUNT
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS COLLECTED_COUPONS,
  SUM(4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") * 1.00 * 1.04) AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS_ID, STUDENTS_ID, COLLECTED_COUPONS, BONUS_AMOUNT
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS COLLECTED_COUPONS,
  SUM(4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") * 1.00 * 1.04) AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS_ID, STUDENTS_ID, COLLECTED_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS COLLECTED_COUPONS,
  SUM(4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") * 1.00 * 1.04) AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS_ID
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS COLLECTED_COUPONS,
  SUM(4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") * 1.00 * 1.04) AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS_ID, BONUS_AMOUNT
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS COLLECTED_COUPONS,
  SUM(4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") * 1.00 * 1.04) AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS_ID, STUDENTS_ID
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS COLLECTED_COUPONS,
  SUM(4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") * 1.00 * 1.04) AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS_ID, STUDENTS_ID
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS COLLECTED_COUPONS,
  SUM(4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") * 1.00 * 1.04) AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS.ID, STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT *
  FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.ID, SUM(ITEMS.NUMBER_OF_COUPONS), ORDERITEMS."NUMBER"
  FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.ID, SUM(ITEMS.NUMBER_OF_COUPONS), ORDERITEMS."NUMBER"
  FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.ID, SUM(ITEMS.NUMBER_OF_COUPONS) * SUM(ORDERITEMS."NUMBER") AS TOTALCOUPONS
FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID, ORDERITEMS."NUMBER"
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.ID, SUM(ITEMS.NUMBER_OF_COUPONS) * SUM(ORDERITEMS."NUMBER")
  FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID, ORDERITEMS."NUMBER"
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.ID, SUM(ITEMS.NUMBER_OF_COUPONS), SUM(ORDERITEMS."NUMBER")
  FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.ID, SUM(ITEMS.NUMBER_OF_COUPONS), COUNT(ORDERITEMS."NUMBER")
  FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER"
  FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID, ORDERITEMS."NUMBER"
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER"
  FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.ID, ITEMS.NUMBER_OF_COUPONS, SUM(ORDERITEMS."NUMBER")
  FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.ID, SUM(ITEMS.NUMBER_OF_COUPONS), ORDERITEMS."NUMBER"
  FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID, ORDERITEMS."NUMBER"
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.ID, SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER"), ORDERITEMS."NUMBER", ITEMS.NUMBER_OF_COUPONS
  FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID, ORDERITEMS."NUMBER", ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.ID, SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER")
  FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID, ORDERITEMS."NUMBER", ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT STUDENTS.ID, SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER")
  FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID, ORDERITEMS."NUMBER", ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT STUDENTS.ID, SUM(SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER"))
  FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID, ORDERITEMS."NUMBER", ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT STUDENTS.ID, SUM(SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER")) AS TOTAL
  FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT STUDENTS.ID, SUM(SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER")) AS TOTAL
  FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID, TOTAL
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT STUDENTS.ID, SUM(SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER"))
  FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT STUDENTS.ID, SUM(SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER"))
  FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER"
;-- -. . -..- - / . -. - .-. -.--
SELECT STUDENTS.ID, SUM(SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER"))
  FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER"
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT STUDENTS.ID, SUM(SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER")) AS TOTAL
  FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER"
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT SUM(SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER")) AS TOTAL
  FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER"
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT SUM(SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER")) AS TOTAL
  FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT (SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER")) AS TOTAL
  FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS TOTAL
  FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT STUDENTS.ID, SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS TOTAL
  FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT STUDENTS.ID, SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS TOTAL
FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT STUDENTS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER"
FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT STUDENTS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER"
FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
;-- -. . -..- - / . -. - .-. -.--
GROUP BY STUDENTS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER";
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT STUDENTS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER"
FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY STUDENTS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER"
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT *
FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT ITEMS_ID, ORDERITEMS.ID, ORDERITEMS."NUMBER", ITEMS.NUMBER_OF_COUPONS
FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT ITEMS.ID, ORDERITEMS.ID, ORDERITEMS."NUMBER", ITEMS.NUMBER_OF_COUPONS
FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT ITEMS.ID as ItemsID, ORDERITEMS.ID, ORDERITEMS."NUMBER", ITEMS.NUMBER_OF_COUPONS
FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT ITEMS.ID as ItemsID, ORDERITEMS.ID as OrderItemsId, ORDERITEMS."NUMBER", ITEMS.NUMBER_OF_COUPONS
FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT ORDERITEMS.ID as OrderItemsId, ITEMS.ID as ItemsID, ORDERITEMS."NUMBER", ITEMS.NUMBER_OF_COUPONS
FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT ORDERITEMS.ID as OrderItemsId, ITEMS.ID as ItemsID, ORDERITEMS."NUMBER", ITEMS.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER" * ITEMS.NUMBER_OF_COUPONS AS totalCoupons
FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT ITEMS.ID as ItemsID, SUM(ORDERITEMS."NUMBER"), SUM(ITEMS.NUMBER_OF_COUPONS), SUM(ORDERITEMS."NUMBER" * ITEMS.NUMBER_OF_COUPONS) AS totalCoupons
FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY ITEMS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT ITEMS.ID as ItemsID, SUM(ORDERITEMS."NUMBER"), SUM(ITEMS.NUMBER_OF_COUPONS), SUM(ORDERITEMS."NUMBER")*SUM(ITEMS.NUMBER_OF_COUPONS) AS totalCoupons
FROM ORDERS
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN STUDENTS
    ON ORDERS.STUDENTS_ID = STUDENTS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  STUDENTS.ID = 1
GROUP BY ITEMS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS COLLECTED_COUPONS,
  SUM(4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") * 1.00 * 1.04) AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS.ID, STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  SUM(ITEMS.NUMBER_OF_COUPONS) * SUM(ORDERITEMS."NUMBER") AS COLLECTED_COUPONS,
  4 * SUM(ITEMS.NUMBER_OF_COUPONS) * SUM(ORDERITEMS."NUMBER") * 1.00 * 1.04 AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS.ID, STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER" AS COLLECTED_COUPONS,
  4 * SUM(ITEMS.NUMBER_OF_COUPONS) * SUM(ORDERITEMS."NUMBER") * 1.00 * 1.04 AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS.ID, STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER" AS COLLECTED_COUPONS,
  4 * SUM(ITEMS.NUMBER_OF_COUPONS) * SUM(ORDERITEMS."NUMBER") * 1.00 * 1.04 AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS.ID, STUDENTS.ID, items.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER"
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  SUM((ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER")) AS COLLECTED_COUPONS,
  4 * ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER" * 1.00 * 1.04 AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS.ID, STUDENTS.ID, items.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER"
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER" AS COLLECTED_COUPONS,
  4 * ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER" * 1.00 * 1.04 AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS.ID, STUDENTS.ID, items.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER"
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER" AS COLLECTED_COUPONS,
  4 * ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER" * 1.00 * 1.04 AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND 
  STUDENTS.ID = 1

GROUP BY EVENTS.ID, STUDENTS.ID, items.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER"
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  --ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER" AS COLLECTED_COUPONS,
  SUM(4 * ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER" * 1.00 * 1.04) AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND 
  STUDENTS.ID = 1

GROUP BY EVENTS.ID, STUDENTS.ID, items.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER"
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  --ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER" AS COLLECTED_COUPONS,
  SUM(4 * ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER" * 1.00 * 1.04) AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  STUDENTS.ID = 1

GROUP BY STUDENTS.ID, EVENTS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER"
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  --ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER" AS COLLECTED_COUPONS,
  COUNT(4 * ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER" * 1.00 * 1.04) AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  STUDENTS.ID = 1

GROUP BY STUDENTS.ID, EVENTS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER"
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  --ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER" AS COLLECTED_COUPONS,
  4 * ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER" * 1.00 * 1.04 AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  STUDENTS.ID = 1

GROUP BY STUDENTS.ID, EVENTS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER"
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  --ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER" AS COLLECTED_COUPONS,
  4 * ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER" * 1.00 * 1.04 AS BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  STUDENTS.ID = 1

GROUP BY STUDENTS.ID, EVENTS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER"
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  --ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER" AS COLLECTED_COUPONS,
  4 * ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER" * 1.00 * 1.04 AS BONUS_AMOUNT,
  SUM(1)
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  STUDENTS.ID = 1

GROUP BY STUDENTS.ID, EVENTS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER"
;-- -. . -..- - / . -. - .-. -.--
SELECT
  ITEMS.ID,
  ITEMS.NUMBER_OF_COUPONS as CouponsPerItem,
  SUM(ORDERITEMS."NUMBER") as TotaalAantalBesteld,
  SUM(ITEMS.NUMBER_OF_COUPONS) as TotaalAantalCoupons
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  STUDENTS.ID = 1 AND ITEMS.ID = 1

GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  ITEMS.ID,
  ITEMS.NUMBER_OF_COUPONS as CouponsPerItem,
  SUM(ORDERITEMS."NUMBER") as TotaalAantalBesteld,
  SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS as TotaalAantalCoupons
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  STUDENTS.ID = 1 AND ITEMS.ID = 1

GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  ITEMS.ID,
  ITEMS.NUMBER_OF_COUPONS as CouponsPerItem,
  SUM(ORDERITEMS."NUMBER") as TotaalAantalBesteld,
  SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS as TotaalAantalCoupons
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  STUDENTS.ID = 1 AND ITEMS.ID = 2

GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  ITEMS.ID,
  ITEMS.NUMBER_OF_COUPONS as CouponsPerItem,
  SUM(ORDERITEMS."NUMBER") as TotaalAantalBesteld,
  SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS as TotaalAantalCoupons
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  STUDENTS.ID = 1 AND ITEMS.ID = 3

GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  ITEMS.ID,
  ITEMS.NUMBER_OF_COUPONS as CouponsPerItem,
  SUM(ORDERITEMS."NUMBER") as TotaalAantalBesteld,
  SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS as TotaalAantalCoupons
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  STUDENTS.ID = 1 AND ITEMS.ID = 4

GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  ITEMS.ID,
  ITEMS.NUMBER_OF_COUPONS as CouponsPerItem,
  SUM(ORDERITEMS."NUMBER") as TotaalAantalBesteld,
  SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS as TotaalAantalCoupons
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  STUDENTS.ID = 1 AND ITEMS.ID = 5

GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  STUDENTS.ID,
  SUM(ORDERITEMS."NUMBER") as TotaalAantalItemsBesteld,
  SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS as TotaalAantalCoupons
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  STUDENTS.ID = 1

GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  STUDENTS.ID,
  SUM(ORDERITEMS."NUMBER") as TotaalAantalItemsBesteld,
  SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS as TotaalAantalCoupons
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  STUDENTS.ID = 1

GROUP BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  STUDENTS.ID,
  SUM(ORDERITEMS."NUMBER") as TotaalAantalItemsBesteld,
  SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS as TotaalAantalCoupons,
  ITEMS.ID
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  STUDENTS.ID = 1

GROUP BY STUDENTS.ID, ITEMS.NUMBER_OF_COUPONS, ITEMS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  STUDENTS.ID,
  SUM(ORDERITEMS."NUMBER") as TotaalAantalItemsBesteld,
  SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS as TotaalAantalCoupons
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  STUDENTS.ID = 1

GROUP BY STUDENTS.ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  STUDENTS.ID,
  SUM(ORDERITEMS."NUMBER") as TotaalAantalItemsBesteld,
  SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS as TotaalAantalCoupons
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND

GROUP BY STUDENTS.ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  STUDENTS.ID,
  ORDERITEMS.ITEMS_ID as ItemId,
  SUM(ORDERITEMS."NUMBER") as TotaalAantalItemsBesteld,
  SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS as TotaalAantalCoupons
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY STUDENTS.ID, ORDERITEMS.ITEMS_ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  STUDENTS.ID as StudentId,
  ORDERITEMS.ITEMS_ID as ItemId,
  SUM(ORDERITEMS."NUMBER") as TotaalAantalItemsBesteld,
  SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS as TotaalAantalCoupons
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY STUDENTS.ID, ORDERITEMS.ITEMS_ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  STUDENTS.ID,
  SUM(ORDERITEMS."NUMBER") as TotaalAantalItemsBesteld,
  SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS as TotaalAantalCoupons
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY STUDENTS.ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT 
  STUDENTS.ID,
  4 * (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) * 1.00 * 1.04 as BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY STUDENTS.ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  STUDENTS.ID,
  4 * (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) * 1.00 * 1.04 as BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY STUDENTS.ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT 
  STUDENTS.ID,
  4 * (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) * 1.00 * 1.04 as BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY STUDENTS.ID, ITEMS.NUMBER_OF_COUPONS
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  STUDENTS.ID,
  4 * (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) * 1.00 * 1.04 as BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY STUDENTS.ID, ITEMS.NUMBER_OF_COUPONS
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  STUDENTS.ID,
  SUM(4 * (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) * 1.00 * 1.04) as BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY STUDENTS.ID
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  STUDENTS.ID,
  SUM(4 * (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) * 1.00 * 1.04) as BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY STUDENTS.ID, EVENTS.ID
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  STUDENTS.ID,
  EVENTS.ID,
  SUM(4 * (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) * 1.00 * 1.04) as BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY STUDENTS.ID, EVENTS.ID
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  SUM(4 * (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) * 1.00 * 1.04) as BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY STUDENTS.ID, EVENTS.ID
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  SUM(4 * (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) * 1.00 * 1.04) as BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  STUDENTS.ID,
  EVENTS.ID,
  SUM(4 * (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) * 1.00 * 1.04) as BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY STUDENTS.ID, EVENTS.ID, ORDERITEMS."NUMBER", ITEMS.NUMBER_OF_COUPONS
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  SUM(4 * (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) * 1.00 * 1.04) as BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY ORDERITEMS."NUMBER", ITEMS.NUMBER_OF_COUPONS
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  SUM(4 * (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) * 1.00 * 1.04) as BONUS_AMOUNT,
  STUDENTS.ID
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY ORDERITEMS."NUMBER", ITEMS.NUMBER_OF_COUPONS
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  SUM(4 * (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) * 1.00 * 1.04) as BONUS_AMOUNT,
  STUDENTS.ID
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY ORDERITEMS."NUMBER", ITEMS.NUMBER_OF_COUPONS
  GROUP BY STUDENTS.ID
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  SUM(4 * (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) * 1.00 * 1.04) as BONUS_AMOUNT,
  STUDENTS.ID
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY ORDERITEMS."NUMBER", ITEMS.NUMBER_OF_COUPONS AND
    STUDENTS.ID
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  SUM(4 * (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) * 1.00 * 1.04) as BONUS_AMOUNT,
  STUDENTS.ID
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY ORDERITEMS."NUMBER", ITEMS.NUMBER_OF_COUPONS AND
    STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  SUM(4 * (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) * 1.00 * 1.04) as BONUS_AMOUNT,
  STUDENTS.ID
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY ORDERITEMS."NUMBER", ITEMS.NUMBER_OF_COUPONS, STUDENTS.ID
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  SUM(4 * (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) * 1.00 * 1.04) as BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY ORDERITEMS."NUMBER", ITEMS.NUMBER_OF_COUPONS, STUDENTS.ID
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  SUM(4 * (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) * 1.00 * 1.04) as BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY STUDENTS.ID, ORDERITEMS."NUMBER", ITEMS.NUMBER_OF_COUPONS
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  STUDENTS.ID,
  (4 * (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) * 1.00 * 1.04) as BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY STUDENTS.ID, ORDERITEMS."NUMBER", ITEMS.NUMBER_OF_COUPONS
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  STUDENTS.ID,
  (4 * (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) * 1.00 * 1.04) as BONUS_AMOUNT
FROM
  STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
JOIN PROPRIETOR_BARS
  ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
JOIN BARS
  ON PROPRIETOR_BARS.BARS_ID = BARS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
      BARS.ID = ORDERS.BARS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY STUDENTS.ID
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS COLLECTED_COUPONS,
  SUM(4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") * 1.00 * 1.04) AS BONUS_AMOUNT
FROM
  STUDENTS
  JOIN APPLIES
    ON STUDENTS.ID = APPLIES.STUDENTS_ID
  JOIN SCHEDULES
    ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
  JOIN EVENTS
    ON SCHEDULES.EVENTS_ID = EVENTS.ID
  JOIN PROPRIETOR_BARS
    ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
  JOIN BARS
    ON PROPRIETOR_BARS.BARS_ID = BARS.ID
  JOIN ORDERS
    ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
       BARS.ID = ORDERS.BARS_ID
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS.ID, STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS COLLECTED_COUPONS,
  SUM(4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") * 1.00 * 1.04) AS BONUS_AMOUNT
FROM
  STUDENTS
  JOIN APPLIES
    ON STUDENTS.ID = APPLIES.STUDENTS_ID
  JOIN SCHEDULES
    ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
  JOIN EVENTS
    ON SCHEDULES.EVENTS_ID = EVENTS.ID
  JOIN PROPRIETOR_BARS
    ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
  JOIN BARS
    ON PROPRIETOR_BARS.BARS_ID = BARS.ID
  JOIN ORDERS
    ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
       BARS.ID = ORDERS.BARS_ID
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS.ID, STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT 
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS COLLECTED_COUPONS,
  SUM(4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") * 1.00 * 1.04) AS BONUS_AMOUNT
FROM
  STUDENTS
  JOIN APPLIES
    ON STUDENTS.ID = APPLIES.STUDENTS_ID
  JOIN SCHEDULES
    ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
  JOIN EVENTS
    ON SCHEDULES.EVENTS_ID = EVENTS.ID
  JOIN PROPRIETOR_BARS
    ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
  JOIN BARS
    ON PROPRIETOR_BARS.BARS_ID = BARS.ID
  JOIN ORDERS
    ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
       BARS.ID = ORDERS.BARS_ID
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS.ID, STUDENTS.ID
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS COLLECTED_COUPONS,
  SUM(4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") * 1.00 * 1.04) AS BONUS_AMOUNT
FROM
  STUDENTS
  JOIN APPLIES
    ON STUDENTS.ID = APPLIES.STUDENTS_ID
  JOIN SCHEDULES
    ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
  JOIN EVENTS
    ON SCHEDULES.EVENTS_ID = EVENTS.ID
  JOIN PROPRIETOR_BARS
    ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
  JOIN BARS
    ON PROPRIETOR_BARS.BARS_ID = BARS.ID
  JOIN ORDERS
    ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
       BARS.ID = ORDERS.BARS_ID
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS.ID, STUDENTS.ID
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS COLLECTED_COUPONS,
  (4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") * 1.00 * 1.04) AS BONUS_AMOUNT
FROM
  STUDENTS
  JOIN APPLIES
    ON STUDENTS.ID = APPLIES.STUDENTS_ID
  JOIN SCHEDULES
    ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
  JOIN EVENTS
    ON SCHEDULES.EVENTS_ID = EVENTS.ID
  JOIN PROPRIETOR_BARS
    ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
  JOIN BARS
    ON PROPRIETOR_BARS.BARS_ID = BARS.ID
  JOIN ORDERS
    ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
       BARS.ID = ORDERS.BARS_ID
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS.ID, STUDENTS.ID
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS COLLECTED_COUPONS,
  (4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") * 1.00 * 1.04) AS BONUS_AMOUNT
FROM
  STUDENTS
  JOIN APPLIES
    ON STUDENTS.ID = APPLIES.STUDENTS_ID
  JOIN SCHEDULES
    ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
  JOIN EVENTS
    ON SCHEDULES.EVENTS_ID = EVENTS.ID
  JOIN PROPRIETOR_BARS
    ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
  JOIN BARS
    ON PROPRIETOR_BARS.BARS_ID = BARS.ID
  JOIN ORDERS
    ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
       BARS.ID = ORDERS.BARS_ID
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS.ID, STUDENTS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER"
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
DISTINCT
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS COLLECTED_COUPONS,
  (4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") * 1.00 * 1.04) AS BONUS_AMOUNT
FROM
  STUDENTS
  JOIN APPLIES
    ON STUDENTS.ID = APPLIES.STUDENTS_ID
  JOIN SCHEDULES
    ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
  JOIN EVENTS
    ON SCHEDULES.EVENTS_ID = EVENTS.ID
  JOIN PROPRIETOR_BARS
    ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
  JOIN BARS
    ON PROPRIETOR_BARS.BARS_ID = BARS.ID
  JOIN ORDERS
    ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
       BARS.ID = ORDERS.BARS_ID
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS.ID, STUDENTS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER"
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT DISTINCT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS COLLECTED_COUPONS,
  SUM(4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") * 1.00 * 1.04) AS BONUS_AMOUNT
FROM
  STUDENTS
  JOIN APPLIES
    ON STUDENTS.ID = APPLIES.STUDENTS_ID
  JOIN SCHEDULES
    ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
  JOIN EVENTS
    ON SCHEDULES.EVENTS_ID = EVENTS.ID
  JOIN PROPRIETOR_BARS
    ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
  JOIN BARS
    ON PROPRIETOR_BARS.BARS_ID = BARS.ID
  JOIN ORDERS
    ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
       BARS.ID = ORDERS.BARS_ID
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS.ID, STUDENTS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER"
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS COLLECTED_COUPONS,
  SUM(4 * (ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") * 1.00 * 1.04) AS BONUS_AMOUNT
FROM
  STUDENTS
  JOIN APPLIES
    ON STUDENTS.ID = APPLIES.STUDENTS_ID
  JOIN SCHEDULES
    ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
  JOIN EVENTS
    ON SCHEDULES.EVENTS_ID = EVENTS.ID
  JOIN PROPRIETOR_BARS
    ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
  JOIN BARS
    ON PROPRIETOR_BARS.BARS_ID = BARS.ID
  JOIN ORDERS
    ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
       BARS.ID = ORDERS.BARS_ID
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS.ID, STUDENTS.ID
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  SUM(ITEMS.NUMBER_OF_COUPONS * ORDERITEMS."NUMBER") AS COLLECTED_COUPONS,
  SUM(4.00 * (CAST(ITEMS.NUMBER_OF_COUPONS AS NUMBER(10, 2)) * CAST(ORDERITEMS."NUMBER" AS NUMBER(10, 2))) * 1.00 * 1.04) AS BONUS_AMOUNT
FROM
  STUDENTS
  JOIN APPLIES
    ON STUDENTS.ID = APPLIES.STUDENTS_ID
  JOIN SCHEDULES
    ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
  JOIN EVENTS
    ON SCHEDULES.EVENTS_ID = EVENTS.ID
  JOIN PROPRIETOR_BARS
    ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
  JOIN BARS
    ON PROPRIETOR_BARS.BARS_ID = BARS.ID
  JOIN ORDERS
    ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
       BARS.ID = ORDERS.BARS_ID
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS.ID, STUDENTS.ID
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  ITEMS.ID,
  ITEMS.NUMBER_OF_COUPONS AS COUPONS_FOR_ITEM, 
FROM
  STUDENTS
  JOIN APPLIES
    ON STUDENTS.ID = APPLIES.STUDENTS_ID
  JOIN SCHEDULES
    ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
  JOIN EVENTS
    ON SCHEDULES.EVENTS_ID = EVENTS.ID
  JOIN PROPRIETOR_BARS
    ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
  JOIN BARS
    ON PROPRIETOR_BARS.BARS_ID = BARS.ID
  JOIN ORDERS
    ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
       BARS.ID = ORDERS.BARS_ID
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS.ID, STUDENTS.ID
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  ITEMS.ID,
  ITEMS.NUMBER_OF_COUPONS AS COUPONS_FOR_ITEM
FROM
  STUDENTS
  JOIN APPLIES
    ON STUDENTS.ID = APPLIES.STUDENTS_ID
  JOIN SCHEDULES
    ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
  JOIN EVENTS
    ON SCHEDULES.EVENTS_ID = EVENTS.ID
  JOIN PROPRIETOR_BARS
    ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
  JOIN BARS
    ON PROPRIETOR_BARS.BARS_ID = BARS.ID
  JOIN ORDERS
    ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
       BARS.ID = ORDERS.BARS_ID
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS.ID, STUDENTS.ID
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  ITEMS.ID,
  ITEMS.NUMBER_OF_COUPONS AS COUPONS_FOR_ITEM
FROM
  STUDENTS
  JOIN APPLIES
    ON STUDENTS.ID = APPLIES.STUDENTS_ID
  JOIN SCHEDULES
    ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
  JOIN EVENTS
    ON SCHEDULES.EVENTS_ID = EVENTS.ID
  JOIN PROPRIETOR_BARS
    ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
  JOIN BARS
    ON PROPRIETOR_BARS.BARS_ID = BARS.ID
  JOIN ORDERS
    ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
       BARS.ID = ORDERS.BARS_ID
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS.ID, STUDENTS.ID, ITEMS.ID, ITEMS.NUMBER_OF_COUPONS
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  ITEMS.ID AS ITEMS_ID,
  ITEMS.NUMBER_OF_COUPONS AS COUPONS_FOR_ITEM,
  SUM(ORDERITEMS."NUMBER") AS SUM_OF_COUPONS
FROM
  STUDENTS
  JOIN APPLIES
    ON STUDENTS.ID = APPLIES.STUDENTS_ID
  JOIN SCHEDULES
    ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
  JOIN EVENTS
    ON SCHEDULES.EVENTS_ID = EVENTS.ID
  JOIN PROPRIETOR_BARS
    ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
  JOIN BARS
    ON PROPRIETOR_BARS.BARS_ID = BARS.ID
  JOIN ORDERS
    ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
       BARS.ID = ORDERS.BARS_ID
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  ITEMS.ID AS ITEMS_ID,
  ITEMS.NUMBER_OF_COUPONS AS COUPONS_FOR_ITEM,
  SUM(ORDERITEMS."NUMBER") AS SUM_OF_COUPONS
FROM
  STUDENTS
  JOIN APPLIES
    ON STUDENTS.ID = APPLIES.STUDENTS_ID
  JOIN SCHEDULES
    ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
  JOIN EVENTS
    ON SCHEDULES.EVENTS_ID = EVENTS.ID
  JOIN PROPRIETOR_BARS
    ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
  JOIN BARS
    ON PROPRIETOR_BARS.BARS_ID = BARS.ID
  JOIN ORDERS
    ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
       BARS.ID = ORDERS.BARS_ID
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER"
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  ITEMS.ID AS ITEMS_ID,
  ITEMS.NUMBER_OF_COUPONS AS COUPONS_FOR_ITEM,
  SUM(ORDERITEMS."NUMBER") AS SUM_OF_COUPONS
FROM
  STUDENTS
  JOIN APPLIES
    ON STUDENTS.ID = APPLIES.STUDENTS_ID
  JOIN SCHEDULES
    ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
  JOIN EVENTS
    ON SCHEDULES.EVENTS_ID = EVENTS.ID
  JOIN PROPRIETOR_BARS
    ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
  JOIN BARS
    ON PROPRIETOR_BARS.BARS_ID = BARS.ID
  JOIN ORDERS
    ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
       BARS.ID = ORDERS.BARS_ID
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERITEMS."NUMBER"
;-- -. . -..- - / . -. - .-. -.--
SELECT
  ITEMS.ID AS ITEMS_ID,
  COUNT(ORDERITEMS."NUMBER") AS SUM_OF_COUPONS
FROM
  STUDENTS
  JOIN APPLIES
    ON STUDENTS.ID = APPLIES.STUDENTS_ID
  JOIN SCHEDULES
    ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
  JOIN EVENTS
    ON SCHEDULES.EVENTS_ID = EVENTS.ID
  JOIN PROPRIETOR_BARS
    ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
  JOIN BARS
    ON PROPRIETOR_BARS.BARS_ID = BARS.ID
  JOIN ORDERS
    ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
       BARS.ID = ORDERS.BARS_ID
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY ITEMS.ID, ORDERITEMS."NUMBER"
;-- -. . -..- - / . -. - .-. -.--
SUM
;-- -. . -..- - / . -. - .-. -.--
SELECT
  ITEMS.ID AS ITEMS_ID,
  SUM(ORDERITEMS."NUMBER") AS SUM_OF_COUPONS
FROM
  STUDENTS
  JOIN APPLIES
    ON STUDENTS.ID = APPLIES.STUDENTS_ID
  JOIN SCHEDULES
    ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
  JOIN EVENTS
    ON SCHEDULES.EVENTS_ID = EVENTS.ID
  JOIN PROPRIETOR_BARS
    ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
  JOIN BARS
    ON PROPRIETOR_BARS.BARS_ID = BARS.ID
  JOIN ORDERS
    ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
       BARS.ID = ORDERS.BARS_ID
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY ITEMS.ID, ORDERITEMS."NUMBER"
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENTS_ID,
  STUDENTS.ID AS STUDENTS_ID,
  ITEMS.ID AS ITEMS_ID,
  ITEMS.NUMBER_OF_COUPONS AS COUPONS_FOR_ITEM
FROM
  STUDENTS
  JOIN APPLIES
    ON STUDENTS.ID = APPLIES.STUDENTS_ID
  JOIN SCHEDULES
    ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
  JOIN EVENTS
    ON SCHEDULES.EVENTS_ID = EVENTS.ID
  JOIN PROPRIETOR_BARS
    ON SCHEDULES.PROPRIETOR_BARS_ID = PROPRIETOR_BARS.ID
  JOIN BARS
    ON PROPRIETOR_BARS.BARS_ID = BARS.ID
  JOIN ORDERS
    ON STUDENTS.ID = ORDERS.STUDENTS_ID AND
       BARS.ID = ORDERS.BARS_ID
  JOIN ORDERITEMS
    ON ORDERS.ID = ORDERITEMS.ORDERS_ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID

WHERE
  EVENTS.ID = 1 AND
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER'

GROUP BY EVENTS.ID, STUDENTS.ID, ITEMS.ID, ITEMS.NUMBER_OF_COUPONS
ORDER BY STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT 
  ITEMS.ID, 
  ITEMS.NUMBER_OF_COUPONS
FROM
  ITEMS
;-- -. . -..- - / . -. - .-. -.--
SELECT 
  ORDERITEMS.ITEMS_ID,
  ORDERITEMS."NUMBER",
  ITEMS.NUMBER_OF_COUPONS
FROM
  ITEMS
JOIN ORDERITEMS
  ON ITEMS.ID = ORDERITEMS.ITEMS_ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  ORDERITEMS.ITEMS_ID,
  SUM(ORDERITEMS."NUMBER"),
  ITEMS.NUMBER_OF_COUPONS
FROM
  ITEMS
JOIN ORDERITEMS
  ON ITEMS.ID = ORDERITEMS.ITEMS_ID
GROUP BY ORDERITEMS.ITEMS_ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  ORDERITEMS.ITEMS_ID,
  SUM(ORDERITEMS."NUMBER"),
  ITEMS.NUMBER_OF_COUPONS
FROM
  ITEMS
JOIN ORDERITEMS
  ON ITEMS.ID = ORDERITEMS.ITEMS_ID
JOIN ORDERS
  ON ORDERITEMS.ORDERS_ID = ORDERS.ID
WHERE
  ORDERS.STUDENTS_ID = 1
GROUP BY ORDERITEMS.ITEMS_ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  ORDERITEMS.ITEMS_ID,
  SUM(ORDERITEMS."NUMBER"),
  ITEMS.NUMBER_OF_COUPONS,
  STUDENTS.ID
FROM
  ITEMS
JOIN ORDERITEMS
  ON ITEMS.ID = ORDERITEMS.ITEMS_ID
JOIN ORDERS
  ON ORDERITEMS.ORDERS_ID = ORDERS.ID
WHERE
  ORDERS.STUDENTS_ID = 1
GROUP BY STUDENTS.ID, ORDERITEMS.ITEMS_ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  ORDERITEMS.ITEMS_ID,
  SUM(ORDERITEMS."NUMBER"),
  ITEMS.NUMBER_OF_COUPONS,
  ORDERS.STUDENTS_ID
FROM
  ITEMS
JOIN ORDERITEMS
  ON ITEMS.ID = ORDERITEMS.ITEMS_ID
JOIN ORDERS
  ON ORDERITEMS.ORDERS_ID = ORDERS.ID
WHERE
  ORDERS.STUDENTS_ID = 1
GROUP BY ORDERS.STUDENTS_ID, ORDERITEMS.ITEMS_ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  SUM(ORDERITEMS."NUMBER"),
  ORDERS.STUDENTS_ID
FROM
  ITEMS
INNER JOIN ORDERITEMS
  ON ITEMS.ID = ORDERITEMS.ITEMS_ID
FULL OUTER JOIN ORDERS
  ON ORDERITEMS.ORDERS_ID = ORDERS.ID
WHERE
  ORDERS.STUDENTS_ID = 1
GROUP BY ORDERS.STUDENTS_ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  SUM(ORDERITEMS."NUMBER"),
  ORDERS.STUDENTS_ID
FROM
  ITEMS
INNER JOIN ORDERITEMS
  ON ITEMS.ID = ORDERITEMS.ITEMS_ID
OUTER JOIN ORDERS
  ON ORDERITEMS.ORDERS_ID = ORDERS.ID
WHERE
  ORDERS.STUDENTS_ID = 1
GROUP BY ORDERS.STUDENTS_ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  SUM(ORDERITEMS."NUMBER"),
  ORDERS.STUDENTS_ID
FROM
  ITEMS
INNER JOIN ORDERITEMS
  ON ITEMS.ID = ORDERITEMS.ITEMS_ID
RIGHT JOIN ORDERS
  ON ORDERITEMS.ORDERS_ID = ORDERS.ID
WHERE
  ORDERS.STUDENTS_ID = 1
GROUP BY ORDERS.STUDENTS_ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  SUM(ORDERITEMS."NUMBER"),
  ORDERS.STUDENTS_ID
FROM
  ITEMS
INNER JOIN ORDERITEMS
  ON ITEMS.ID = ORDERITEMS.ITEMS_ID
LEFT JOIN ORDERS
  ON ORDERITEMS.ORDERS_ID = ORDERS.ID
WHERE
  ORDERS.STUDENTS_ID = 1
GROUP BY ORDERS.STUDENTS_ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  SUM(ORDERITEMS."NUMBER"),
  ORDERS.STUDENTS_ID
FROM
  ITEMS
LEFT JOIN ORDERITEMS
  ON ITEMS.ID = ORDERITEMS.ITEMS_ID
LEFT JOIN ORDERS
  ON ORDERITEMS.ORDERS_ID = ORDERS.ID
WHERE
  ORDERS.STUDENTS_ID = 1
GROUP BY ORDERS.STUDENTS_ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  SUM(ORDERITEMS."NUMBER"),
  ORDERS.STUDENTS_ID
FROM
  ITEMS
LEFT JOIN ORDERITEMS
  ON ITEMS.ID = ORDERITEMS.ITEMS_ID
RIGHT JOIN ORDERS
  ON ORDERITEMS.ORDERS_ID = ORDERS.ID
WHERE
  ORDERS.STUDENTS_ID = 1
GROUP BY ORDERS.STUDENTS_ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  SUM(ORDERITEMS."NUMBER"),
  ORDERS.STUDENTS_ID
FROM
  ITEMS
INNER JOIN ORDERITEMS
  ON ITEMS.ID = ORDERITEMS.ITEMS_ID
INNER JOIN ORDERS
  ON ORDERITEMS.ORDERS_ID = ORDERS.ID
WHERE
  ORDERS.STUDENTS_ID = 1
GROUP BY ORDERS.STUDENTS_ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  SUM(ORDERITEMS."NUMBER"),
  ORDERS.STUDENTS_ID
FROM
  ITEMS
JOIN ORDERITEMS
  ON ITEMS.ID = ORDERITEMS.ITEMS_ID
JOIN ORDERS
  ON ORDERITEMS.ORDERS_ID = ORDERS.ID
WHERE
  ORDERS.STUDENTS_ID = 1
GROUP BY ORDERS.STUDENTS_ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT * FROM ORDERS WHERE STUDENTS_ID=1
;-- -. . -..- - / . -. - .-. -.--
SELECT
  ORDERS.STUDENTS_ID,
  SUM(ORDERITEMS."NUMBER")
FROM
  ITEMS
JOIN ORDERITEMS
  ON ITEMS.ID = ORDERITEMS.ITEMS_ID
JOIN ORDERS
  ON ORDERITEMS.ORDERS_ID = ORDERS.ID
WHERE
  ORDERS.STUDENTS_ID = 1
GROUP BY ORDERS.STUDENTS_ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  SUM(ORDERITEMS."NUMBER")
FROM
  ITEMS
JOIN ORDERITEMS
  ON ITEMS.ID = ORDERITEMS.ITEMS_ID
JOIN ORDERS
  ON ORDERITEMS.ORDERS_ID = ORDERS.ID
WHERE
  ORDERS.STUDENTS_ID = 1
GROUP BY ORDERS.STUDENTS_ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  SUM(ORDERITEMS."NUMBER")
FROM
  ITEMS
JOIN ORDERITEMS
  ON ITEMS.ID = ORDERITEMS.ITEMS_ID
JOIN ORDERS
  ON ORDERITEMS.ORDERS_ID = ORDERS.ID
WHERE
  ORDERS.STUDENTS_ID = 1
GROUP BY ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  SUM(ORDERITEMS."NUMBER")
FROM
  ORDERITEMS
JOIN ORDERS
  ON ORDERITEMS.ORDERS_ID = ORDERS.ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  ORDERS.STUDENTS_ID = 1
GROUP BY ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  SUM(ORDERITEMS."NUMBER") AS TOTALORDERED
FROM
  ORDERITEMS
JOIN ORDERS
  ON ORDERITEMS.ORDERS_ID = ORDERS.ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  ORDERS.STUDENTS_ID = 1
GROUP BY ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  ITEMS.ID,
  SUM(ORDERITEMS."NUMBER") AS TOTALORDERED
FROM
  ORDERITEMS
JOIN ORDERS
  ON ORDERITEMS.ORDERS_ID = ORDERS.ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  ORDERS.STUDENTS_ID = 1
GROUP BY ITEMS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  ITEMS.ID,
  SUM(ORDERITEMS."NUMBER") AS TOTALORDERED,
  (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) AS TOTALCOUPONS
FROM
  ORDERITEMS
JOIN ORDERS
  ON ORDERITEMS.ORDERS_ID = ORDERS.ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  ORDERS.STUDENTS_ID = 1
GROUP BY ITEMS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  ITEMS.ID,
  SUM(ORDERITEMS."NUMBER") AS TOTALORDERED,
  (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) AS TOTALCOUPONS
FROM
  ORDERITEMS
JOIN ORDERS
  ON ORDERITEMS.ORDERS_ID = ORDERS.ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  ORDERS.STUDENTS_ID = 1
GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENT_ID,
  STUDENTS.ID AS STUDENT_ID,
  SUM(SUB1.TOTALCOUPONS) AS BONUS_AMOUNT
FROM
  STUDENTS,
  (SELECT
    ITEMS.ID,
    SUM(ORDERITEMS."NUMBER") AS TOTALORDERED,
    (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) AS TOTALCOUPONS
  FROM
    ORDERITEMS
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
  WHERE
    ORDERS.STUDENTS_ID = STUDENTS.ID
  GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS) SUB1
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID

WHERE
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  EVENTS.ID = 1

GROUP BY EVENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENT_ID,
  STUDENTS.ID AS STUDENT_ID,
  SUM(SUB1.TOTALCOUPONS) AS BONUS_AMOUNT
FROM
  STUDENTS,
  (SELECT
    ITEMS.ID,
    SUM(ORDERITEMS."NUMBER") AS TOTALORDERED,
    (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) AS TOTALCOUPONS
  FROM
    ORDERITEMS
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
  WHERE
    ORDERS.STUDENTS_ID = STUDENTS.ID
  GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS) SUB1
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID

WHERE
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  EVENTS.ID = 1

GROUP BY EVENTS.ID, STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENT_ID,
--   STUDENTS.ID AS STUDENT_ID,
  SUM(SUB1.TOTALCOUPONS) AS BONUS_AMOUNT
FROM
  (SELECT
    ITEMS.ID,
    SUM(ORDERITEMS."NUMBER") AS TOTALORDERED,
    (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) AS TOTALCOUPONS
  FROM
    ORDERITEMS
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
  WHERE
    ORDERS.STUDENTS_ID = STUDENTS.ID
  GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS) SUB1, STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID

WHERE
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  EVENTS.ID = 1

GROUP BY EVENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENT_ID,
  STUDENTS.ID AS STUDENT_ID,
  SUM(SUB1.TOTALCOUPONS) AS BONUS_AMOUNT
FROM
  (SELECT
    ITEMS.ID,
    SUM(ORDERITEMS."NUMBER") AS TOTALORDERED,
    (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) AS TOTALCOUPONS
  FROM
    ORDERITEMS
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
  WHERE
    ORDERS.STUDENTS_ID = STUDENTS.ID
  GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS) SUB1, STUDENTS
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID

WHERE
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  EVENTS.ID = 1

GROUP BY EVENTS.ID, STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
      ITEMS.ID,
      ORDERS.STUDENTS_ID
      SUM(ORDERITEMS."NUMBER") AS TOTALORDERED,
      (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) AS TOTALCOUPONS
    FROM
      ORDERITEMS
    JOIN ORDERS
      ON ORDERITEMS.ORDERS_ID = ORDERS.ID
    JOIN ITEMS
      ON ORDERITEMS.ITEMS_ID = ITEMS.ID
    WHERE
      ORDERS.STUDENTS_ID = STUDENTS.ID
    GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERS.STUDENTS_ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  ITEMS.ID,
  ORDERS.STUDENTS_ID
                                                          SUM(ORDERITEMS."NUMBER") AS TOTALORDERED,
  (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) AS TOTALCOUPONS
FROM
  ORDERITEMS
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  ORDERS.STUDENTS_ID = STUDENTS.ID
GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERS.STUDENTS_ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  ITEMS.ID,
  ORDERS.STUDENTS_ID,
  SUM(ORDERITEMS."NUMBER") AS TOTALORDERED,
  (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) AS TOTALCOUPONS
FROM
  ORDERITEMS
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  ORDERS.STUDENTS_ID = STUDENTS.ID
GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERS.STUDENTS_ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  ITEMS.ID,
  ORDERS.STUDENTS_ID,
  SUM(ORDERITEMS."NUMBER") AS TOTALORDERED,
  (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) AS TOTALCOUPONS
FROM
  ORDERITEMS
  JOIN ORDERS
    ON ORDERITEMS.ORDERS_ID = ORDERS.ID
  JOIN ITEMS
    ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  ORDERS.STUDENTS_ID = 1
GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERS.STUDENTS_ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
      ITEMS.ID,
      ORDERS.STUDENTS_ID,
      SUM(ORDERITEMS."NUMBER") AS TOTALORDERED,
      (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) AS TOTALCOUPONS
    FROM
      ORDERITEMS
    JOIN ORDERS
      ON ORDERITEMS.ORDERS_ID = ORDERS.ID
    JOIN ITEMS
      ON ORDERITEMS.ITEMS_ID = ITEMS.ID
    GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERS.STUDENTS_ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENT_ID,
  STUDENTS.ID AS STUDENT_ID,
  SUM(SUB1.TOTALCOUPONS) AS BONUS_AMOUNT
FROM
  STUDENTS
  JOIN (SELECT
      ITEMS.ID,
      ORDERS.STUDENTS_ID AS STUDENTS_ID,
      SUM(ORDERITEMS."NUMBER") AS TOTALORDERED,
      (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) AS TOTALCOUPONS
    FROM
      ORDERITEMS
    JOIN ORDERS
      ON ORDERITEMS.ORDERS_ID = ORDERS.ID
    JOIN ITEMS
      ON ORDERITEMS.ITEMS_ID = ITEMS.ID
    GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERS.STUDENTS_ID)
  ON STUDENTS_ID = STUDENTS.ID
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID

WHERE
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  EVENTS.ID = 1

GROUP BY EVENTS.ID, STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENT_ID,
  STUDENTS.ID AS STUDENT_ID,
  SUM(SUB1.TOTALCOUPONS) AS BONUS_AMOUNT
FROM
  STUDENTS
  JOIN (SELECT
      ITEMS.ID,
      ORDERS.STUDENTS_ID AS STUDENTS_ID,
      SUM(ORDERITEMS."NUMBER") AS TOTALORDERED,
      (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) AS TOTALCOUPONS
    FROM
      ORDERITEMS
    JOIN ORDERS
      ON ORDERITEMS.ORDERS_ID = ORDERS.ID
    JOIN ITEMS
      ON ORDERITEMS.ITEMS_ID = ITEMS.ID
    GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERS.STUDENTS_ID) SUB1
  ON STUDENTS_ID = STUDENTS.ID
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID

WHERE
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  EVENTS.ID = 1

GROUP BY EVENTS.ID, STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
      ITEMS.ID,
      ORDERS.STUDENTS_ID AS STUDENTS_ID,
      SUM(ORDERITEMS."NUMBER") AS TOTALORDERED,
      (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) AS TOTALCOUPONS
    FROM
      ORDERITEMS
    JOIN ORDERS
      ON ORDERITEMS.ORDERS_ID = ORDERS.ID
    JOIN ITEMS
      ON ORDERITEMS.ITEMS_ID = ITEMS.ID
    GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERS.STUDENTS_ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
      ITEMS.ID AS ITEM_ID,
      ORDERS.STUDENTS_ID AS STUDENTS_ID,
      SUM(ORDERITEMS."NUMBER") AS TOTALORDERED,
      (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) AS TOTALCOUPONS
    FROM
      ORDERITEMS
    JOIN ORDERS
      ON ORDERITEMS.ORDERS_ID = ORDERS.ID
    JOIN ITEMS
      ON ORDERITEMS.ITEMS_ID = ITEMS.ID
    GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERS.STUDENTS_ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENT_ID,
  STUDENTS.ID AS STUDENT_ID,
  SUM(SUB1.TOTALCOUPONS) AS BONUS_AMOUNT
FROM
  STUDENTS
  JOIN (SELECT
      ITEMS.ID AS ITEM_ID,
      ORDERS.STUDENTS_ID AS STUDENTS_ID,
      SUM(ORDERITEMS."NUMBER") AS TOTALORDERED,
      (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) AS TOTALCOUPONS
    FROM
      ORDERITEMS
    JOIN ORDERS
      ON ORDERITEMS.ORDERS_ID = ORDERS.ID
    JOIN ITEMS
      ON ORDERITEMS.ITEMS_ID = ITEMS.ID
    GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERS.STUDENTS_ID) SUB1
  ON STUDENTS_ID = STUDENTS.ID
JOIN APPLIES
  ON STUDENTS.ID = APPLIES.STUDENTS_ID
JOIN SCHEDULES
  ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID

WHERE
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  EVENTS.ID = 1

GROUP BY EVENTS.ID, STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
CREATE OR REPLACE PROCEDURE CALC_STUDENT_EVENT_BONUS (
  P_EVENT_ID IN EVENTS.ID%TYPE,
  P_EVENT_DURATION IN TIMESTAMP -- Because hours are not included in database..
) AS
-- DECLARE THE AMOUNT OF BONUS BY TYPE OF EVENT
QUIET_EVENT NUMBER(1, 2) := 1.02;
NORMAL_EVENT NUMBER(1, 2) := 1.04;
ROUGH_EVENT NUMBER(1, 2) := 1.07;

-- Other variables
eventType VARCHAR2(200);
eventBonus NUMBER(1, 2);
amountOfHoursWorked NUMBER(2);
  BEGIN

  -- Bonus is amountOfHoursWorked * collectedCoupons * 1.00 * eventBonus
  -- Requirement: Has to have been working in a bar during the event

  -- firstly determine the eventBonus
    SELECT TYPE INTO eventType FROM EVENTS WHERE ID = P_EVENT_ID;
    CASE eventType
      WHEN 'ROUGH' THEN eventBonus = ROUGH_EVENT;
      WHEN 'NORMAL' THEN eventBonus = NORMAL_EVENT;
      WHEN 'QUIET' THEN eventBonus = QUIET_EVENT;
    END CASE;

  -- determine amountOfHours worked
    amountOfHoursWorked := P_EVENT_DURATION;
--   SELECT to_number(to_char(SCHEDULES.ENDDATETIME, 'HH24'))-to_number(to_char(SCHEDULES.BEGINDATETIME, 'HH24'))
--     INTO amountOfHoursWorked
--   FROM EVENTS
--     JOIN SCHEDULES
--       ON SCHEDULES.EVENTS_ID = EVENTS.ID
--     JOIN APPLIES
--       ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
--     JOIN STUDENTS
--       ON STUDENTS.ID = APPLIES.STUDENTS_ID
--   WHERE
--     EVENTS.ID = P_EVENT_ID AND
--     APPLIES.STATUS = 'PLANNED' AND      -- With PLANNED status and not being COUPON_SELLER we
--     APPLIES.CAPACITY != 'COUPON_SELLER' -- trust that the student has been working at a bar
--     ;

    -- determine collected coupons and calculate bonus for every student
    -- also perform insert
    INSERT INTO STUDENTS_BONUS (STUDENT_ID, EVENT_ID, BONUS_AMOUNT, COLLECTED_COUPONS)
    SELECT
      STUDENTS.ID AS STUDENT_ID,
      EVENTS.ID AS EVENT_ID,
      (P_EVENT_DURATION * SUM(SUB1.TOTALCOUPONS) * 1.00 * eventBonus) AS BONUS_AMOUNT,
      SUM(SUB1).TOTALCOUPONS AS COLLECTED_COUPONS
    FROM
      STUDENTS
      JOIN (SELECT
              ITEMS.ID AS ITEM_ID,
              ORDERS.STUDENTS_ID AS STUDENTS_ID,
              SUM(ORDERITEMS."NUMBER") AS TOTALORDERED,
              (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) AS TOTALCOUPONS
            FROM
              ORDERITEMS
              JOIN ORDERS
                ON ORDERITEMS.ORDERS_ID = ORDERS.ID
              JOIN ITEMS
                ON ORDERITEMS.ITEMS_ID = ITEMS.ID
            GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERS.STUDENTS_ID) SUB1
        ON STUDENTS_ID = STUDENTS.ID
      JOIN APPLIES
        ON STUDENTS.ID = APPLIES.STUDENTS_ID
      JOIN SCHEDULES
        ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
      JOIN EVENTS
        ON SCHEDULES.EVENTS_ID = EVENTS.ID
    WHERE
      APPLIES.STATUS = 'PLANNED' AND
      APPLIES.CAPACITY != 'COUPON_SELLER' AND
      EVENTS.ID = P_EVENT_ID
    GROUP BY EVENTS.ID, STUDENTS.ID;

END CALC_STUDENT_EVENT_BONUS;
;-- -. . -..- - / . -. - .-. -.--
CREATE OR REPLACE PROCEDURE CALC_STUDENT_EVENT_BONUS (
  P_EVENT_ID IN EVENTS.ID%TYPE,
  P_EVENT_DURATION IN TIMESTAMP -- Because hours are not included in database..
) AS
-- DECLARE THE AMOUNT OF BONUS BY TYPE OF EVENT
QUIET_EVENT NUMBER(1, 2) := 1.02;
NORMAL_EVENT NUMBER(1, 2) := 1.04;
ROUGH_EVENT NUMBER(1, 2) := 1.07;

-- Other variables
eventType VARCHAR2(200);
eventBonus NUMBER(1, 2);
amountOfHoursWorked NUMBER(2);
  BEGIN

  -- Bonus is amountOfHoursWorked * collectedCoupons * 1.00 * eventBonus
  -- Requirement: Has to have been working in a bar during the event

  -- firstly determine the eventBonus
    SELECT TYPE INTO eventType FROM EVENTS WHERE ID = P_EVENT_ID;
    CASE eventType
      WHEN 'ROUGH' THEN eventBonus := ROUGH_EVENT;
      WHEN 'NORMAL' THEN eventBonus := NORMAL_EVENT;
      WHEN 'QUIET' THEN eventBonus := QUIET_EVENT;
    END CASE;

  -- determine amountOfHours worked
    amountOfHoursWorked := P_EVENT_DURATION;
--   SELECT to_number(to_char(SCHEDULES.ENDDATETIME, 'HH24'))-to_number(to_char(SCHEDULES.BEGINDATETIME, 'HH24'))
--     INTO amountOfHoursWorked
--   FROM EVENTS
--     JOIN SCHEDULES
--       ON SCHEDULES.EVENTS_ID = EVENTS.ID
--     JOIN APPLIES
--       ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
--     JOIN STUDENTS
--       ON STUDENTS.ID = APPLIES.STUDENTS_ID
--   WHERE
--     EVENTS.ID = P_EVENT_ID AND
--     APPLIES.STATUS = 'PLANNED' AND      -- With PLANNED status and not being COUPON_SELLER we
--     APPLIES.CAPACITY != 'COUPON_SELLER' -- trust that the student has been working at a bar
--     ;

    -- determine collected coupons and calculate bonus for every student
    -- also perform insert
    INSERT INTO STUDENTS_BONUS (STUDENT_ID, EVENT_ID, BONUS_AMOUNT, COLLECTED_COUPONS)
    SELECT
      STUDENTS.ID AS STUDENT_ID,
      EVENTS.ID AS EVENT_ID,
      (P_EVENT_DURATION * SUM(SUB1.TOTALCOUPONS) * 1.00 * eventBonus) AS BONUS_AMOUNT,
      SUM(SUB1).TOTALCOUPONS AS COLLECTED_COUPONS
    FROM
      STUDENTS
      JOIN (SELECT
              ITEMS.ID AS ITEM_ID,
              ORDERS.STUDENTS_ID AS STUDENTS_ID,
              SUM(ORDERITEMS."NUMBER") AS TOTALORDERED,
              (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) AS TOTALCOUPONS
            FROM
              ORDERITEMS
              JOIN ORDERS
                ON ORDERITEMS.ORDERS_ID = ORDERS.ID
              JOIN ITEMS
                ON ORDERITEMS.ITEMS_ID = ITEMS.ID
            GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERS.STUDENTS_ID) SUB1
        ON STUDENTS_ID = STUDENTS.ID
      JOIN APPLIES
        ON STUDENTS.ID = APPLIES.STUDENTS_ID
      JOIN SCHEDULES
        ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
      JOIN EVENTS
        ON SCHEDULES.EVENTS_ID = EVENTS.ID
    WHERE
      APPLIES.STATUS = 'PLANNED' AND
      APPLIES.CAPACITY != 'COUPON_SELLER' AND
      EVENTS.ID = P_EVENT_ID
    GROUP BY EVENTS.ID, STUDENTS.ID;

END CALC_STUDENT_EVENT_BONUS;
;-- -. . -..- - / . -. - .-. -.--
SELECT
  STUDENTS.ID AS STUDENT_ID,
  EVENTS.ID AS EVENT_ID,
  (P_EVENT_DURATION * SUM(SUB1.TOTALCOUPONS) * 1.00 * eventBonus) AS BONUS_AMOUNT,
  SUM(SUB1.TOTALCOUPONS) AS COLLECTED_COUPONS
FROM
  STUDENTS
  JOIN (SELECT
          ITEMS.ID AS ITEM_ID,
          ORDERS.STUDENTS_ID AS STUDENTS_ID,
          SUM(ORDERITEMS."NUMBER") AS TOTALORDERED,
          (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) AS TOTALCOUPONS
        FROM
          ORDERITEMS
          JOIN ORDERS
            ON ORDERITEMS.ORDERS_ID = ORDERS.ID
          JOIN ITEMS
            ON ORDERITEMS.ITEMS_ID = ITEMS.ID
        GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERS.STUDENTS_ID) SUB1
    ON STUDENTS_ID = STUDENTS.ID
  JOIN APPLIES
    ON STUDENTS.ID = APPLIES.STUDENTS_ID
  JOIN SCHEDULES
    ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
  JOIN EVENTS
    ON SCHEDULES.EVENTS_ID = EVENTS.ID
WHERE
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  EVENTS.ID = P_EVENT_ID
GROUP BY EVENTS.ID, STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  STUDENTS.ID AS STUDENT_ID,
  EVENTS.ID AS EVENT_ID,
  (4 * SUM(SUB1.TOTALCOUPONS) * 1.00 * 1.04) AS BONUS_AMOUNT,
  SUM(SUB1.TOTALCOUPONS) AS COLLECTED_COUPONS
FROM
  STUDENTS
  JOIN (SELECT
          ITEMS.ID AS ITEM_ID,
          ORDERS.STUDENTS_ID AS STUDENTS_ID,
          SUM(ORDERITEMS."NUMBER") AS TOTALORDERED,
          (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) AS TOTALCOUPONS
        FROM
          ORDERITEMS
          JOIN ORDERS
            ON ORDERITEMS.ORDERS_ID = ORDERS.ID
          JOIN ITEMS
            ON ORDERITEMS.ITEMS_ID = ITEMS.ID
        GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERS.STUDENTS_ID) SUB1
    ON STUDENTS_ID = STUDENTS.ID
  JOIN APPLIES
    ON STUDENTS.ID = APPLIES.STUDENTS_ID
  JOIN SCHEDULES
    ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
  JOIN EVENTS
    ON SCHEDULES.EVENTS_ID = EVENTS.ID
WHERE
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  EVENTS.ID = 1
GROUP BY EVENTS.ID, STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
INSERT INTO STUDENTS_BONUS
  (STUDENT_ID, EVENT_ID, BONUS_AMOUNT, COLLECTED_COUPONS)
SELECT
  STUDENTS.ID AS STUDENT_ID,
  EVENTS.ID AS EVENT_ID,
  (4 * SUM(SUB1.TOTALCOUPONS) * 1.00 * 1.04) AS BONUS_AMOUNT,
  SUM(SUB1.TOTALCOUPONS) AS COLLECTED_COUPONS
FROM
  STUDENTS
  JOIN (SELECT
          ITEMS.ID AS ITEM_ID,
          ORDERS.STUDENTS_ID AS STUDENTS_ID,
          SUM(ORDERITEMS."NUMBER") AS TOTALORDERED,
          (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) AS TOTALCOUPONS
        FROM
          ORDERITEMS
          JOIN ORDERS
            ON ORDERITEMS.ORDERS_ID = ORDERS.ID
          JOIN ITEMS
            ON ORDERITEMS.ITEMS_ID = ITEMS.ID
        GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERS.STUDENTS_ID) SUB1
    ON STUDENTS_ID = STUDENTS.ID
  JOIN APPLIES
    ON STUDENTS.ID = APPLIES.STUDENTS_ID
  JOIN SCHEDULES
    ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
  JOIN EVENTS
    ON SCHEDULES.EVENTS_ID = EVENTS.ID
WHERE
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  EVENTS.ID = 1
GROUP BY EVENTS.ID, STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
CREATE OR REPLACE PROCEDURE CALC_STUDENT_EVENT_BONUS (
  P_EVENT_ID IN EVENTS.ID%TYPE,
  P_EVENT_DURATION IN TIMESTAMP -- Because hours are not included in database..
) AS
-- DECLARE THE AMOUNT OF BONUS BY TYPE OF EVENT
QUIET_EVENT NUMBER(1, 2) := 1.02;
NORMAL_EVENT NUMBER(1, 2) := 1.04;
ROUGH_EVENT NUMBER(1, 2) := 1.07;

-- Other variables
eventType VARCHAR2(200);
eventBonus NUMBER(1, 2);
amountOfHoursWorked NUMBER(2);
  BEGIN

  -- Bonus is amountOfHoursWorked * collectedCoupons * 1.00 * eventBonus
  -- Requirement: Has to have been working in a bar during the event

  -- firstly determine the eventBonus
    SELECT TYPE INTO eventType FROM EVENTS WHERE ID = P_EVENT_ID;
    CASE eventType
      WHEN 'ROUGH' THEN eventBonus := ROUGH_EVENT;
      WHEN 'NORMAL' THEN eventBonus := NORMAL_EVENT;
      WHEN 'QUIET' THEN eventBonus := QUIET_EVENT;
    END CASE;

  -- determine amountOfHours worked
    amountOfHoursWorked := P_EVENT_DURATION;
--   SELECT to_number(to_char(SCHEDULES.ENDDATETIME, 'HH24'))-to_number(to_char(SCHEDULES.BEGINDATETIME, 'HH24'))
--     INTO amountOfHoursWorked
--   FROM EVENTS
--     JOIN SCHEDULES
--       ON SCHEDULES.EVENTS_ID = EVENTS.ID
--     JOIN APPLIES
--       ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
--     JOIN STUDENTS
--       ON STUDENTS.ID = APPLIES.STUDENTS_ID
--   WHERE
--     EVENTS.ID = P_EVENT_ID AND
--     APPLIES.STATUS = 'PLANNED' AND      -- With PLANNED status and not being COUPON_SELLER we
--     APPLIES.CAPACITY != 'COUPON_SELLER' -- trust that the student has been working at a bar
--     ;

    -- determine collected coupons and calculate bonus for every student
    -- also perform insert
    INSERT INTO STUDENTS_BONUS
      (STUDENT_ID, EVENT_ID, BONUS_AMOUNT, COLLECTED_COUPONS)
    SELECT
      STUDENTS.ID AS STUDENT_ID,
      EVENTS.ID AS EVENT_ID,
      (P_EVENT_DURATION * SUM(SUB1.TOTALCOUPONS) * 1.00 * eventBonus) AS BONUS_AMOUNT,
      SUM(SUB1.TOTALCOUPONS) AS COLLECTED_COUPONS
    FROM
      STUDENTS
      JOIN (SELECT
              ITEMS.ID AS ITEM_ID,
              ORDERS.STUDENTS_ID AS STUDENTS_ID,
              SUM(ORDERITEMS."NUMBER") AS TOTALORDERED,
              (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) AS TOTALCOUPONS
            FROM
              ORDERITEMS
              JOIN ORDERS
                ON ORDERITEMS.ORDERS_ID = ORDERS.ID
              JOIN ITEMS
                ON ORDERITEMS.ITEMS_ID = ITEMS.ID
            GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERS.STUDENTS_ID) SUB1
        ON STUDENTS_ID = STUDENTS.ID
      JOIN APPLIES
        ON STUDENTS.ID = APPLIES.STUDENTS_ID
      JOIN SCHEDULES
        ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
      JOIN EVENTS
        ON SCHEDULES.EVENTS_ID = EVENTS.ID
    WHERE
      APPLIES.STATUS = 'PLANNED' AND
      APPLIES.CAPACITY != 'COUPON_SELLER' AND
      EVENTS.ID = P_EVENT_ID
    GROUP BY EVENTS.ID, STUDENTS.ID;

END CALC_STUDENT_EVENT_BONUS;
;-- -. . -..- - / . -. - .-. -.--
SELECT
  STUDENTS.ID AS STUDENT_ID,
  EVENTS.ID AS EVENT_ID,
  (2.5 * SUM(SUB1.TOTALCOUPONS) * 1.00 * 0.04) AS BONUS_AMOUNT,
  SUM(SUB1.TOTALCOUPONS) AS COLLECTED_COUPONS
FROM
  STUDENTS
  JOIN (SELECT
          ITEMS.ID AS ITEM_ID,
          ORDERS.STUDENTS_ID AS STUDENTS_ID,
          SUM(ORDERITEMS."NUMBER") AS TOTALORDERED,
          (SUM(ORDERITEMS."NUMBER") * ITEMS.NUMBER_OF_COUPONS) AS TOTALCOUPONS
        FROM
          ORDERITEMS
          JOIN ORDERS
            ON ORDERITEMS.ORDERS_ID = ORDERS.ID
          JOIN ITEMS
            ON ORDERITEMS.ITEMS_ID = ITEMS.ID
        GROUP BY ITEMS.ID, ITEMS.NUMBER_OF_COUPONS, ORDERS.STUDENTS_ID) SUB1
    ON STUDENTS_ID = STUDENTS.ID
  JOIN APPLIES
    ON STUDENTS.ID = APPLIES.STUDENTS_ID
  JOIN SCHEDULES
    ON APPLIES.SCHEDULES_ID = SCHEDULES.ID
  JOIN EVENTS
    ON SCHEDULES.EVENTS_ID = EVENTS.ID
WHERE
  APPLIES.STATUS = 'PLANNED' AND
  APPLIES.CAPACITY != 'COUPON_SELLER' AND
  EVENTS.ID = 1
GROUP BY EVENTS.ID, STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENT,
  STUDENTS.NAME AS WAITER,
  ORDERS.ID AS ORDER_ID,
  ITEMS.NAME AS ORDER_ITEM,
  ITEMS.TYPE AS TYPE_OF_CONSUMPTION,
  ORDERS.DATEORDER AS "DATE",
  to_number(to_char(ORDERS.DATEORDER, 'WW')) AS WEEK,
  to_number(to_char(ORDERS.DATEORDER, 'DAY')) AS DAY
FROM
  ORDERS
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
JOIN BARS
  ON ORDERS.BARS_ID = BARS.ID
JOIN PROPRIETOR_BARS
  ON BARS.ID = PROPRIETOR_BARS.BARS_ID
JOIN SCHEDULES
  ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
JOIN APPLIES
  ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
JOIN STUDENTS
  ON ORDERS.STUDENTS_ID = STUDENTS.ID AND APPLIES.STUDENTS_ID
WHERE 
  APPLIES.CAPACITY = 'WAITER'
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENT,
  STUDENTS.NAME AS WAITER,
  ORDERS.ID AS ORDER_ID,
  ITEMS.NAME AS ORDER_ITEM,
  ITEMS.TYPE AS TYPE_OF_CONSUMPTION,
  ORDERS.DATEORDER AS "DATE",
  to_number(to_char(ORDERS.DATEORDER, 'WW')) AS WEEK,
  to_number(to_char(ORDERS.DATEORDER, 'DAY')) AS DAY
FROM
  ORDERS
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
JOIN BARS
  ON ORDERS.BARS_ID = BARS.ID
JOIN PROPRIETOR_BARS
  ON BARS.ID = PROPRIETOR_BARS.BARS_ID
JOIN SCHEDULES
  ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
JOIN APPLIES
  ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
JOIN STUDENTS
  ON ORDERS.STUDENTS_ID = STUDENTS.ID AND APPLIES.STUDENTS_ID = STUDENTS.ID
WHERE 
  APPLIES.CAPACITY = 'WAITER'
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENT,
  STUDENTS.NAME AS WAITER,
  ORDERS.ID AS ORDER_ID,
  ITEMS.NAME AS ORDER_ITEM,
  ITEMS.TYPE AS TYPE_OF_CONSUMPTION,
  ORDERS.DATEORDER AS DATE,
  to_number(to_char(ORDERS.DATEORDER, 'WW')) AS WEEK,
  to_number(to_char(ORDERS.DATEORDER, 'DAY')) AS DAY
FROM
  ORDERS
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
JOIN BARS
  ON ORDERS.BARS_ID = BARS.ID
JOIN PROPRIETOR_BARS
  ON BARS.ID = PROPRIETOR_BARS.BARS_ID
JOIN SCHEDULES
  ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
JOIN APPLIES
  ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
JOIN STUDENTS
  ON ORDERS.STUDENTS_ID = STUDENTS.ID AND APPLIES.STUDENTS_ID = STUDENTS.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
WHERE
  APPLIES.CAPACITY = 'WAITER'
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENT,
  STUDENTS.NAME AS WAITER,
  ORDERS.ID AS ORDER_ID,
  ITEMS.NAME AS ORDER_ITEM,
  ITEMS.TYPE AS TYPE_OF_CONSUMPTION,
  ORDERS.DATEORDER AS "DATE",
  to_number(to_char(ORDERS.DATEORDER, 'WW')) AS WEEK,
  to_number(to_char(ORDERS.DATEORDER, 'DAY')) AS DAY
FROM
  ORDERS
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
JOIN BARS
  ON ORDERS.BARS_ID = BARS.ID
JOIN PROPRIETOR_BARS
  ON BARS.ID = PROPRIETOR_BARS.BARS_ID
JOIN SCHEDULES
  ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
JOIN APPLIES
  ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
JOIN STUDENTS
  ON ORDERS.STUDENTS_ID = STUDENTS.ID AND APPLIES.STUDENTS_ID = STUDENTS.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
WHERE
  APPLIES.CAPACITY = 'WAITER'
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENT,
  STUDENTS.NAME AS WAITER,
  ORDERS.ID AS ORDER_ID,
  ITEMS.NAME AS ORDER_ITEM,
  ITEMS.TYPE AS TYPE_OF_CONSUMPTION,
  ORDERS.DATEORDER AS "DATE",
  to_number(to_char(ORDERS.DATEORDER, 'WW')) AS WEEK,
  to_char(ORDERS.DATEORDER, 'DAY') AS DAY
FROM
  ORDERS
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
JOIN BARS
  ON ORDERS.BARS_ID = BARS.ID
JOIN PROPRIETOR_BARS
  ON BARS.ID = PROPRIETOR_BARS.BARS_ID
JOIN SCHEDULES
  ON PROPRIETOR_BARS.ID = SCHEDULES.PROPRIETOR_BARS_ID
JOIN APPLIES
  ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
JOIN STUDENTS
  ON ORDERS.STUDENTS_ID = STUDENTS.ID AND APPLIES.STUDENTS_ID = STUDENTS.ID
JOIN EVENTS
  ON SCHEDULES.EVENTS_ID = EVENTS.ID
WHERE
  APPLIES.CAPACITY = 'WAITER'
;-- -. . -..- - / . -. - .-. -.--
select
  students.name as student_name,
  events.name as event_name,
  sum (orderitems."NUMBER" *items.number_of_coupons) as "TOTAL COUPONS"
from
  STUDENTS
  join applies
    on students.id = applies.students_id
  join orders
    on students.id = orders.students_id
  join orderitems
    on orders.id = orderitems.orders_id
  join items
    on orderitems.items_id = items.id
  join schedules
    on applies.schedules_id = schedules.id
  join events
    on schedules.events_id = events.id
where
  applies.status = 'PLANNED' AND
  applies.capacity != 'COUPON_SELLER' AND
  events.id = 1
group by event_id,student_id,TOTAL_COUPONS
;-- -. . -..- - / . -. - .-. -.--
select
  students.name as student_name,
  events.name as event_name,
  sum(orderitems."NUMBER" *items.number_of_coupons) as "TOTAL COUPONS"
from
  STUDENTS
  join applies
    on students.id = applies.students_id
  join orders
    on students.id = orders.students_id
  join orderitems
    on orders.id = orderitems.orders_id
  join items
    on orderitems.items_id = items.id
  join schedules
    on applies.schedules_id = schedules.id
  join events
    on schedules.events_id = events.id
where
  applies.status = 'PLANNED' AND
  applies.capacity != 'COUPON_SELLER' AND
  events.id = 1
group by event_id,student_id,TOTAL_COUPONS
;-- -. . -..- - / . -. - .-. -.--
select
  students.name as student_name,
  events.name as event_name,
  sum(orderitems."NUMBER" * items.number_of_coupons) as "TOTAL COUPONS"
from
  STUDENTS
  join applies
    on students.id = applies.students_id
  join orders
    on students.id = orders.students_id
  join orderitems
    on orders.id = orderitems.orders_id
  join items
    on orderitems.items_id = items.id
  join schedules
    on applies.schedules_id = schedules.id
  join events
    on schedules.events_id = events.id
where
  applies.status = 'PLANNED' AND
  applies.capacity != 'COUPON_SELLER' AND
  events.id = 1
group by event_id,student_id,TOTAL_COUPONS
;-- -. . -..- - / . -. - .-. -.--
select
  students.name as student_name,
  events.name as event_name,
  sum(orderitems."NUMBER" * items.number_of_coupons) as TOTAL_COUPONS
from
  STUDENTS
  join applies
    on students.id = applies.students_id
  join orders
    on students.id = orders.students_id
  join orderitems
    on orders.id = orderitems.orders_id
  join items
    on orderitems.items_id = items.id
  join schedules
    on applies.schedules_id = schedules.id
  join events
    on schedules.events_id = events.id
where
  applies.status = 'PLANNED' AND
  applies.capacity != 'COUPON_SELLER' AND
  events.id = 1
group by event_id,student_id,TOTAL_COUPONS
;-- -. . -..- - / . -. - .-. -.--
select
  STUDENTS.name as student_name,
  EVENTS.name as event_name,
  sum(ORDERITEMS."NUMBER" * ITEMS.number_of_coupons) as TOTAL_COUPONS
from
  STUDENTS
  join applies
    on students.id = applies.students_id
  join orders
    on students.id = orders.students_id
  join orderitems
    on orders.id = orderitems.orders_id
  join items
    on orderitems.items_id = items.id
  join schedules
    on applies.schedules_id = schedules.id
  join events
    on schedules.events_id = events.id
where
  applies.status = 'PLANNED' AND
  applies.capacity != 'COUPON_SELLER' AND
  events.id = 1
group by event_id,student_id,TOTAL_COUPONS
;-- -. . -..- - / . -. - .-. -.--
select
  STUDENTS.name as student_name,
  EVENTS.name as event_name,
  SUM(ORDERITEMS."NUMBER" * ITEMS.number_of_coupons) AS TOTAL_COUPONS
from
  STUDENTS
  join applies
    on students.id = applies.students_id
  join orders
    on students.id = orders.students_id
  join orderitems
    on orders.id = orderitems.orders_id
  join items
    on orderitems.items_id = items.id
  join schedules
    on applies.schedules_id = schedules.id
  join events
    on schedules.events_id = events.id
where
  applies.status = 'PLANNED' AND
  applies.capacity != 'COUPON_SELLER' AND
  events.id = 1
group by event_id,student_id,TOTAL_COUPONS
;-- -. . -..- - / . -. - .-. -.--
select
  STUDENTS.name as student_name,
  EVENTS.name as event_name,
  SUM(ORDERITEMS."NUMBER" * ITEMS.number_of_coupons) AS TOTAL_COUPONS
from
  STUDENTS
  join applies
    on students.id = applies.students_id
  join orders
    on students.id = orders.students_id
  join orderitems
    on orders.id = orderitems.orders_id
  join items
    on orderitems.items_id = items.id
  join schedules
    on applies.schedules_id = schedules.id
  join events
    on schedules.events_id = events.id
where
  applies.status = 'PLANNED' AND
  applies.capacity != 'COUPON_SELLER' AND
  events.id = 1
group by event_id,student_id
;-- -. . -..- - / . -. - .-. -.--
select
  STUDENTS.name as student_name,
  EVENTS.name as event_name,
  SUM(ORDERITEMS."NUMBER" * ITEMS.NUMBER_OF_COUPONS) AS TOTAL_COUPONS
from
  STUDENTS
  join applies
    on students.id = applies.students_id
  join orders
    on students.id = orders.students_id
  join orderitems
    on orders.id = orderitems.orders_id
  join items
    on orderitems.items_id = items.id
  join schedules
    on applies.schedules_id = schedules.id
  join events
    on schedules.events_id = events.id
where
  applies.status = 'PLANNED' AND
  applies.capacity != 'COUPON_SELLER' AND
  events.id = 1
group by event_id,student_id
;-- -. . -..- - / . -. - .-. -.--
select
  STUDENTS.name as student_name,
  EVENTS.name as event_name,
  SUM(ORDERITEMS."NUMBER") AS TOTAL_COUPONS
from
  STUDENTS
  join applies
    on students.id = applies.students_id
  join orders
    on students.id = orders.students_id
  join orderitems
    on orders.id = orderitems.orders_id
  join items
    on orderitems.items_id = items.id
  join schedules
    on applies.schedules_id = schedules.id
  join events
    on schedules.events_id = events.id
where
  applies.status = 'PLANNED' AND
  applies.capacity != 'COUPON_SELLER' AND
  events.id = 1
group by event_id,student_id
;-- -. . -..- - / . -. - .-. -.--
select
  STUDENTS.name as student_name,
  EVENTS.name as event_name,
  SUM(ORDERITEMS."NUMBER") AS TOTAL_COUPONS
from
  STUDENTS
  join applies
    on students.id = applies.students_id
  join orders
    on students.id = orders.students_id
  join orderitems
    on orders.id = orderitems.orders_id
  join items
    on orderitems.items_id = items.id
  join schedules
    on applies.schedules_id = schedules.id
  join events
    on schedules.events_id = events.id
where
  applies.status = 'PLANNED' AND
  applies.capacity != 'COUPON_SELLER' AND
  events.id = 1
group by event_id
;-- -. . -..- - / . -. - .-. -.--
select
  STUDENTS.name as student_name,
  EVENTS.name as event_name,
  SUM(ORDERITEMS."NUMBER") AS TOTAL_COUPONS
from
  STUDENTS
  join applies
    on students.id = applies.students_id
  join orders
    on students.id = orders.students_id
  join orderitems
    on orders.id = orderitems.orders_id
  join items
    on orderitems.items_id = items.id
  join schedules
    on applies.schedules_id = schedules.id
  join events
    on schedules.events_id = events.id
where
  applies.status = 'PLANNED' AND
  applies.capacity != 'COUPON_SELLER' AND
  events.id = 1
group by student_name
;-- -. . -..- - / . -. - .-. -.--
select
  STUDENTS.name as student_name,
  EVENTS.name as event_name,
  SUM(ORDERITEMS."NUMBER" * ITEMS.NUMBER_OF_COUPONS) AS TOTAL_COUPONS
from
  STUDENTS
  join applies
    on students.id = applies.students_id
  join orders
    on students.id = orders.students_id
  join orderitems
    on orders.id = orderitems.orders_id
  join items
    on orderitems.items_id = items.id
  join schedules
    on applies.schedules_id = schedules.id
  join events
    on schedules.events_id = events.id
where
  applies.status = 'PLANNED' AND
  applies.capacity != 'COUPON_SELLER' AND
  events.id = 1
group by EVENTS.ID,STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
select
  STUDENTS.name as student_name,
  EVENTS.name as event_name,
  SUM(ORDERITEMS."NUMBER" * ITEMS.NUMBER_OF_COUPONS) AS TOTAL_COUPONS
from
  STUDENTS
  join applies
    on students.id = applies.students_id
  join orders
    on students.id = orders.students_id
  join orderitems
    on orders.id = orderitems.orders_id
  join items
    on orderitems.items_id = items.id
  join schedules
    on applies.schedules_id = schedules.id
  join events
    on schedules.events_id = events.id
where
  applies.status = 'PLANNED' AND
  applies.capacity != 'COUPON_SELLER' AND
  events.id = 1
group by EVENTS.ID, STUDENTS.ID, STUDENTS.NAME, EVENTS.NAME
;-- -. . -..- - / . -. - .-. -.--
select
  students.name as student_name,
  events.name as event_name,
  sum (orderitems."NUMBER" *items.number_of_coupons) as "TOTAL COUPONS"
from
  STUDENTS
  join applies
    on students.id = applies.students_id
  join orders
    on students.id = orders.students_id
  join orderitems
    on orders.id = orderitems.orders_id
  join items
    on orderitems.items_id = items.id
  join schedules
    on applies.schedules_id = schedules.id
  join events
    on schedules.events_id = events.id
where
  applies.status = 'PLANNED' AND
  applies.capacity != 'COUPON_SELLER' AND
  events.id = 1
group by event_id,student_id
;-- -. . -..- - / . -. - .-. -.--
select
  students.name as student_name,
  events.name as event_name,
  sum (orderitems."NUMBER" *items.number_of_coupons) as "TOTAL COUPONS"
from
  STUDENTS
  join applies
    on students.id = applies.students_id
  join orders
    on students.id = orders.students_id
  join orderitems
    on orders.id = orderitems.orders_id
  join items
    on orderitems.items_id = items.id
  join schedules
    on applies.schedules_id = schedules.id
  join events
    on schedules.events_id = events.id
where
  applies.status = 'PLANNED' AND
  applies.capacity != 'COUPON_SELLER' AND
  events.id = 1
group by EVENTS.ID,STUDENTS.ID
;-- -. . -..- - / . -. - .-. -.--
select
  students.name as student_name,
  events.name as event_name,
  sum (orderitems."NUMBER" *items.number_of_coupons) as "TOTAL COUPONS"
from
  STUDENTS
  join applies
    on students.id = applies.students_id
  join orders
    on students.id = orders.students_id
  join orderitems
    on orders.id = orderitems.orders_id
  join items
    on orderitems.items_id = items.id
  join schedules
    on applies.schedules_id = schedules.id
  join events
    on schedules.events_id = events.id
where
  applies.status = 'PLANNED' AND
  applies.capacity != 'COUPON_SELLER' AND
  events.id = 1
group by EVENTS.ID,STUDENTS.ID, student_name, event_name
;-- -. . -..- - / . -. - .-. -.--
select
  students.name as student_name,
  events.name as event_name,
  sum (orderitems."NUMBER" *items.number_of_coupons) as "TOTAL COUPONS"
from
  STUDENTS
  join applies
    on students.id = applies.students_id
  join orders
    on students.id = orders.students_id
  join orderitems
    on orders.id = orderitems.orders_id
  join items
    on orderitems.items_id = items.id
  join schedules
    on applies.schedules_id = schedules.id
  join events
    on schedules.events_id = events.id
where
  applies.status = 'PLANNED' AND
  applies.capacity != 'COUPON_SELLER' AND
  events.id = 1
group by students.name, events.name
;-- -. . -..- - / . -. - .-. -.--
select
  students.name as student_name,
  events.name as event_name,
  sum (orderitems."NUMBER" *items.number_of_coupons) as "TOTAL COUPONS"
from
  STUDENTS
  join applies
    on students.id = applies.students_id
  join orders
    on students.id = orders.students_id
  join orderitems
    on orders.id = orderitems.orders_id
  join items
    on orderitems.items_id = items.id
  join schedules
    on applies.schedules_id = schedules.id
  join events
    on schedules.events_id = events.id
where
  applies.status = 'PLANNED' AND
  applies.capacity != 'COUPON_SELLER' AND
  events.id = 1
group by student_name, events.name
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENT,
  STUDENTS.NAME AS WAITER,
  ORDERS.ID AS ORDER_ID,
  ORDERITEMS.ID AS ORDERITEM,
  ITEMS.TYPE AS TYPE_OF_CONSUMPTION,
  ORDERS.DATEORDER AS "DATE",
  TO_NUMBER(TO_CHAR(ORDERS.DATEORDER, 'IW')) AS WEEK,
  TO_NUMBER(TO_CHAR(ORDERS.DATEORDER, 'DAY')) AS DAY
FROM
  EVENTS
JOIN SCHEDULES
  ON EVENTS.ID = SCHEDULES.EVENTS_ID
JOIN APPLIES
  ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
JOIN STUDENTS
  ON APPLIES.STUDENTS_ID = STUDENTS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  APPLIES.CAPACITY = 'WAITER'
GROUP BY STUDENTS.NAME, ORDERS.ID
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENT,
  STUDENTS.NAME AS WAITER,
  ORDERS.ID AS ORDER_ID,
  ORDERITEMS.ID AS ORDERITEM,
  ITEMS.TYPE AS TYPE_OF_CONSUMPTION,
  ORDERS.DATEORDER AS "DATE",
  TO_NUMBER(TO_CHAR(ORDERS.DATEORDER, 'IW')) AS WEEK,
  TO_NUMBER(TO_CHAR(ORDERS.DATEORDER, 'DAY')) AS DAY
FROM
  EVENTS
JOIN SCHEDULES
  ON EVENTS.ID = SCHEDULES.EVENTS_ID
JOIN APPLIES
  ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
JOIN STUDENTS
  ON APPLIES.STUDENTS_ID = STUDENTS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  APPLIES.CAPACITY = 'WAITER'
GROUP BY STUDENTS.NAME, ORDERS.ID, ORDERITEMS.ID, ITEMS.TYPE, ORDERS.DATEORDER
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENT,
  STUDENTS.NAME AS WAITER,
  ORDERS.ID AS ORDER_ID,
  ORDERITEMS.ID AS ORDERITEM,
  ITEMS.TYPE AS TYPE_OF_CONSUMPTION,
  ORDERS.DATEORDER AS "DATE",
  TO_NUMBER(TO_CHAR(ORDERS.DATEORDER, 'IW')) AS WEEK,
  TO_NUMBER(TO_CHAR(ORDERS.DATEORDER, 'DAY')) AS DAY
FROM
  EVENTS
JOIN SCHEDULES
  ON EVENTS.ID = SCHEDULES.EVENTS_ID
JOIN APPLIES
  ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
JOIN STUDENTS
  ON APPLIES.STUDENTS_ID = STUDENTS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  APPLIES.CAPACITY = 'WAITER'
GROUP BY EVENTS.ID, STUDENTS.NAME, ORDERS.ID, ORDERITEMS.ID, ITEMS.TYPE, ORDERS.DATEORDER
;-- -. . -..- - / . -. - .-. -.--
SELECT
  EVENTS.ID AS EVENT,
  STUDENTS.NAME AS WAITER,
  ORDERS.ID AS ORDER_ID,
  ORDERITEMS.ID AS ORDERITEM,
  ITEMS.TYPE AS TYPE_OF_CONSUMPTION,
  ORDERS.DATEORDER AS "DATE",
  TO_NUMBER(TO_CHAR(ORDERS.DATEORDER, 'IW')) AS WEEK,
  TO_CHAR(ORDERS.DATEORDER, 'DAY') AS DAY
FROM
  EVENTS
JOIN SCHEDULES
  ON EVENTS.ID = SCHEDULES.EVENTS_ID
JOIN APPLIES
  ON SCHEDULES.ID = APPLIES.SCHEDULES_ID
JOIN STUDENTS
  ON APPLIES.STUDENTS_ID = STUDENTS.ID
JOIN ORDERS
  ON STUDENTS.ID = ORDERS.STUDENTS_ID
JOIN ORDERITEMS
  ON ORDERS.ID = ORDERITEMS.ORDERS_ID
JOIN ITEMS
  ON ORDERITEMS.ITEMS_ID = ITEMS.ID
WHERE
  APPLIES.CAPACITY = 'WAITER'
GROUP BY EVENTS.ID, STUDENTS.NAME, ORDERS.ID, ORDERITEMS.ID, ITEMS.TYPE, ORDERS.DATEORDER